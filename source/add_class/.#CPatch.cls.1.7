VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "CPatch"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Private m_Conn As ADODB.Connection

Public AddEditMode As SHOW_MODE_TYPE
Public QueryFlag As Long
Public OrderBy As Long
Public OrderType As Long
Public Flag As String
' End of generic data member

Private Sub Class_Initialize()
   Set m_Conn = glbDatabaseMngr.DBConnection
End Sub

Public Function IsPatch(VersionStr As String) As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim TempRs As ADODB.Recordset
Dim ItemCount As Long
Dim Result As Boolean

   Set TempRs = New ADODB.Recordset
   Result = True
   
   SQL = "SELECT * FROM PATCH_DELIVERY WHERE PATCH_VERSION = '" & VersionStr & "' "
   Call glbDatabaseMngr.GetRs(SQL, "", False, ItemCount, TempRs, glbErrorLog)

   If TempRs.EOF Then
      Result = fasle
   End If
   
   If TempRs.State = adStateOpen Then
      TempRs.Close
   End If
   Set TempRs = Nothing
   
   IsPatch = Result
   Exit Function
   
ErrorHandler:
   IsPatch = False
End Function

Public Function Patch_1_0_12_2() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_2"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE IMPORT_ITEM ADD TOTAL_ACTUAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE IMPORT_ITEM ADD TOTAL_INCLUDE_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE IMPORT_ITEM SET TOTAL_ACTUAL_PRICE = TOTAL_PRICE "
   m_Conn.Execute (SQL)

   SQL = "UPDATE IMPORT_ITEM SET TOTAL_INCLUDE_PRICE = TOTAL_PRICE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE IMPORT_ITEM DROP TOTAL_PRICE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_2 = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_3() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_3"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE IMPORT_ITEM ADD TOTAL_ACTUAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_3 = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_9_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_9_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE DO_ITEM ADD FROM_PERIOD DATE_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE DO_ITEM ADD TO_PERIOD DATE_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_9_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_10_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_10_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE PROCESS "
   SQL = SQL & "( "
   SQL = SQL & "PROCESS_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "PROCESS_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "PROCESS_NAME          CODE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE PROCESS ADD CONSTRAINT PROCESS_ID_PK PRIMARY KEY (PROCESS_ID) "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR PROCESS_SEQ "
   m_Conn.Execute (SQL)


   SQL = "CREATE TABLE MACHINE "
   SQL = SQL & "( "
   SQL = SQL & "MACHINE_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "MACHINE_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "MACHINE_NAME          CODE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE MACHINE ADD CONSTRAINT MACHINE_ID_PK PRIMARY KEY (MACHINE_ID) "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR MACHINE_SEQ "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_10_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_11_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_11_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_11_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_12_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_12_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_12_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_13_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_13_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE JOB "
   SQL = SQL & "( "
   SQL = SQL & "JOB_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "JOB_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "JOB_DATE          DATE_TYPE NOT NULL, "
   SQL = SQL & "JOB_DESC          DESC_TYPE , "
   SQL = SQL & "BATCH_NO          CODE_TYPE , "
   SQL = SQL & "PROCESS_ID      ID_TYPE , "
   SQL = SQL & "APPROVED_BY      ID_TYPE , "
   SQL = SQL & "RESPONSE_BY      ID_TYPE , "
   SQL = SQL & "START_DATE      DATE_TYPE , "
   SQL = SQL & "FINISH_DATE      DATE_TYPE , "
   SQL = SQL & "SUCCESS_FLAG      FLAG_TYPE , "
   SQL = SQL & "INVENTORY_DOC_ID      ID_TYPE, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE TABLE JOB_INOUT "
   SQL = SQL & "( "
   SQL = SQL & "JOB_INOUT_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "JOB_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "PART_ITEM_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "LOCATION_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "LINK_ID           ID_TYPE , "
   SQL = SQL & "TX_TYPE          CODE_TYPE , "
   SQL = SQL & "TX_AMOUNT          MONEY_TYPE , "
   SQL = SQL & "SERIAL_NUMBER          NAME_TYPE , "
   SQL = SQL & "INOUT_REF          CODE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE TABLE JOB_RESOURCE "
   SQL = SQL & "( "
   SQL = SQL & "JOB_RESOURCE_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "JOB_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "MACHINE_ID           ID_TYPE , "
   SQL = SQL & "MACHINE_ID_HOUR           TIME_TYPE , "
   SQL = SQL & "MACHINE_ID_HOURN           TIME_TYPE , "
   SQL = SQL & "EMP_ID          ID_TYPE , "
   SQL = SQL & "EMP_ID_HOUR          TIME_TYPE , "
   SQL = SQL & "EMP_ID_HOURN          TIME_TYPE , "
   SQL = SQL & "OCCUPY_DATE          DATE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   
   m_Conn.Execute (SQL)
   SQL = "CREATE GENERATOR JOB_SEQ "
   m_Conn.Execute (SQL)
  SQL = "CREATE GENERATOR JOB_INOUT_SEQ "
   m_Conn.Execute (SQL)
 SQL = "CREATE GENERATOR JOB_RESOURCE_SEQ "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE JOB ADD CONSTRAINT JOB_ID_PK PRIMARY KEY (JOB_ID) "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE JOB_INOUT ADD CONSTRAINT JOB_INOUT_ID_PK PRIMARY KEY (JOB_INOUT_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_RESOURCE ADD CONSTRAINT JOB_RESOURCE_ID_PK PRIMARY KEY (JOB_RESOURCE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE JOB ADD CONSTRAINT PROCESS_ID_FK5 FOREIGN KEY (PROCESS_ID) REFERENCES PROCESS"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB ADD CONSTRAINT APPROVED_BY_FK FOREIGN KEY (APPROVED_BY) REFERENCES EMPLOYEE"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE JOB ADD CONSTRAINT RESPONSE_BY_FK FOREIGN KEY (RESPONSE_BY) REFERENCES EMPLOYEE"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE JOB ADD CONSTRAINT INVENTORY_DOC_ID_FK FOREIGN KEY (INVENTORY_DOC_ID) REFERENCES INVENTORY_DOC"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_INOUT ADD CONSTRAINT JOB_ID_FK FOREIGN KEY (JOB_ID) REFERENCES JOB"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_INOUT ADD CONSTRAINT PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_INOUT ADD CONSTRAINT LOCATION_ID_FK FOREIGN KEY (LOCATION_ID) REFERENCES LOCATION"
   m_Conn.Execute (SQL)

   SQL = "   ALTER TABLE JOB_RESOURCE ADD CONSTRAINT JOB_ID_FK2 FOREIGN KEY (JOB_ID) REFERENCES JOB"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE JOB_RESOURCE ADD CONSTRAINT MACHINE_ID_FK FOREIGN KEY (MACHINE_ID) REFERENCES MACHINE"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_RESOURCE ADD CONSTRAINT EMP_ID_FK2 FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE"
   m_Conn.Execute (SQL)
   
   SQL = "DROP TABLE FORMULA_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "DROP TABLE FORMULA_ITEM "
   m_Conn.Execute (SQL)
   
   SQL = "DROP TABLE FORMULA_PRICE "
   m_Conn.Execute (SQL)
   
   SQL = "DROP TABLE FORMULA "
   m_Conn.Execute (SQL)

   SQL = "CREATE TABLE FORMULA "
   SQL = SQL & "( "
   SQL = SQL & "FORMULA_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "FORMULA_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "FORMULA_TYPE           ID_TYPE , "
   SQL = SQL & "FORMULA_DATE           DATE_TYPE , "
   SQL = SQL & "FORMULA_DESC           DESC_TYPE , "
   SQL = SQL & "APPROVED_BY          ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID          ID_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

 SQL = "CREATE TABLE FORMULA_ITEM "
   SQL = SQL & "( "
   SQL = SQL & "FORMULA_ITEM_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "FORMULA_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "PART_ITEM_ID           ID_TYPE , "
   SQL = SQL & "ITEM_PERCENT           MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE TABLE FORMULA_TYPE "
   SQL = SQL & "( "
   SQL = SQL & "FORMULA_TYPE_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "FORMULA_TYPE_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "FORMULA_TYPE_NAME           CODE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
      
   SQL = "ALTER TABLE FORMULA ADD CONSTRAINT FORMULA_ID_PK PRIMARY KEY (FORMULA_ID) "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE FORMULA_ITEM ADD CONSTRAINT FORMULA_ITEM_ID_PK PRIMARY KEY (FORMULA_ITEM_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA_TYPE ADD CONSTRAINT FORMULA_TYPE_ID_PK PRIMARY KEY (FORMULA_TYPE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA ADD CONSTRAINT FORMULA_FMR_TYPE_FK FOREIGN KEY (FORMULA_TYPE) REFERENCES FORMULA_TYPE"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA ADD CONSTRAINT FORMULA_EMP_ID_FK FOREIGN KEY (APPROVED_BY) REFERENCES EMPLOYEE"
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE FORMULA ADD CONSTRAINT FORMULA_PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
      
   SQL = "ALTER TABLE FORMULA_ITEM ADD CONSTRAINT FORMULA_ITEM_FORMULA_ID_FK FOREIGN KEY (FORMULA_ID) REFERENCES FORMULA"
   m_Conn.Execute (SQL)
  
  SQL = "ALTER TABLE FORMULA_ITEM ADD CONSTRAINT FORMULA_ITEM_PART_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM"
 m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_11_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_14_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_14_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE JOB ADD JOB_DOC_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE JOB_INOUT ADD FROM_FORMULA ID_TYPE "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE JOB_INOUT ADD CONSTRAINT JOB_INOUT_FML_FK1 FOREIGN KEY (FROM_FORMULA) REFERENCES FORMULA "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE JOB_RESOURCE ADD OCCUPY_INTERVAL MONEY_TYPE "
   m_Conn.Execute (SQL)
      
   SQL = "ALTER TABLE FORMULA_ITEM ADD FROM_FORMULA ID_TYPE "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE FORMULA_ITEM ADD LOCATION_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA_ITEM ADD CONSTRAINT FORMULA_ITEM_FML_FK1 FOREIGN KEY (FROM_FORMULA) REFERENCES FORMULA "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE FORMULA_ITEM ADD CONSTRAINT FORMULA_ITEM_LOCATION_FK1 FOREIGN KEY (LOCATION_ID) REFERENCES LOCATION "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_14_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_15_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_15_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE JOB_INOUT ADD AVG_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA ADD LOCATION_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA ADD CONSTRAINT FORMULA_LOCATION_FK1 FOREIGN KEY (LOCATION_ID) REFERENCES LOCATION "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR QUOATATION_NUMBER_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_15_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function


Public Function Patch_1_0_12_15_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_15_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE CURRENCY "
   SQL = SQL & "( "
   SQL = SQL & "CURRENCY_EXC_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "CURRENCY_EXC_NO           CODE_TYPE NOT NULL, "
   SQL = SQL & "EXCHANGE_DATE          DATE_TYPE NOT NULL, "
   SQL = SQL & "COUNTRY_ID1      ID_TYPE NOT NULL, "
   SQL = SQL & "COUNTRY_ID2      ID_TYPE NOT NULL, "
   SQL = SQL & "COEFFICIENT      MONEY_TYPE NOT NULL, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE TABLE PKGLST_ITEM"
   SQL = SQL & "( "
   SQL = SQL & "PKGLST_ITEM_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "BILLING_DOC_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "PKG_NUMBER           CODE_TYPE NOT NULL, "
   SQL = SQL & "DESCRIPTION           DESC_TYPE , "
   SQL = SQL & "QUANTITY           MONEY_TYPE , "
   SQL = SQL & "MEASURE          MONEY_TYPE , "
   SQL = SQL & "NET_WEIGHT          MONEY_TYPE , "
   SQL = SQL & "GROSS_WEIGHT          MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR CURRENCY_SEQ "
   m_Conn.Execute (SQL)
  SQL = "CREATE GENERATOR PKGLST_ITEM_SEQ "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CURRENCY ADD CONSTRAINT CURRENCY_ID_PK PRIMARY KEY (CURRENCY_EXC_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PKGLST_ITEM ADD CONSTRAINT PKGLST_ITEM_ID_PK PRIMARY KEY (PKGLST_ITEM_ID) "
   m_Conn.Execute (SQL)
   
   
   SQL = " ALTER TABLE CURRENCY ADD CONSTRAINT CURRENCY_COUNTRY_ID_FK FOREIGN KEY (COUNTRY_ID1) REFERENCES COUNTRY"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CURRENCY ADD CONSTRAINT CURRENCY_COUNTRY_ID_FK2 FOREIGN KEY (COUNTRY_ID2) REFERENCES COUNTRY"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE PKGLST_ITEM ADD CONSTRAINT PKGLST_ITEM_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC"
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_15_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_16_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_16_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE  EMP_CHILD ADD PHONE PHONE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EMP_DEPENDENCY ADD PHONE PHONE_TYPE "
   m_Conn.Execute (SQL)
   
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_16_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function


Public Function Patch_1_0_12_17_jill() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_17_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

     SQL = "DROP TABLE CURRENCY "
     m_Conn.Execute (SQL)

    SQL = "CREATE TABLE MONEY_FAMILY "
    SQL = SQL & "( "
    SQL = SQL & "MONEY_FAMILY_ID         ID_TYPE NOT NULL, "
    SQL = SQL & "MONEY_FAMILY_NO       CODE_TYPE NOT NULL, "
    SQL = SQL & "MONEY_FAMILY_NAME       CODE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
    SQL = SQL & ") "
    m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR MONEY_FAMILY_SEQ "
   m_Conn.Execute (SQL)

    SQL = "ALTER TABLE MONEY_FAMILY ADD CONSTRAINT MONEY_FAMILY_ID_PK PRIMARY KEY (MONEY_FAMILY_ID) "
   m_Conn.Execute (SQL)

    SQL = "CREATE TABLE CURRENCY "
    SQL = SQL & "( "
    SQL = SQL & "CURRENCY_EXC_ID      ID_TYPE NOT NULL, "
    SQL = SQL & "CURRENCY_EXC_NO           CODE_TYPE NOT NULL, "
    SQL = SQL & "EXCHANGE_DATE          DATE_TYPE NOT NULL, "
    SQL = SQL & "MONEY_FAMILY_ID1      ID_TYPE NOT NULL, "
    SQL = SQL & "MONEY_FAMILY_ID2      ID_TYPE NOT NULL, "
    SQL = SQL & "COEFFICIENT      MONEY_TYPE NOT NULL, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
    SQL = SQL & ") "
    m_Conn.Execute (SQL)

 SQL = "ALTER TABLE CURRENCY ADD CONSTRAINT CURRENCY_ID_PK PRIMARY KEY (CURRENCY_EXC_ID) "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE CURRENCY ADD CONSTRAINT MONEY_FAMILY_ID_FK FOREIGN KEY (MONEY_FAMILY_ID1) REFERENCES MONEY_FAMILY "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE CURRENCY ADD CONSTRAINT MONEY_FAMILY_ID_FK2 FOREIGN KEY (MONEY_FAMILY_ID2) REFERENCES MONEY_FAMILY "
   m_Conn.Execute (SQL)

 SQL = "CREATE TABLE PARAMETER_PROCESS "
    SQL = SQL & "( "
    SQL = SQL & "PARAMETER_PROCESS_ID         ID_TYPE NOT NULL, "
    SQL = SQL & "PARAMETER_PROCESS_NO       CODE_TYPE NOT NULL, "
    SQL = SQL & "PARAMETER_PROCESS_NAME       CODE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
    SQL = SQL & ") "
    m_Conn.Execute (SQL)

SQL = "CREATE GENERATOR PARAMETER_PROCESS_SEQ "
   m_Conn.Execute (SQL)

    SQL = "ALTER TABLE PARAMETER_PROCESS ADD CONSTRAINT PARAMETER_PROCESS_ID_PK PRIMARY KEY (PARAMETER_PROCESS_ID); "
   m_Conn.Execute (SQL)

    SQL = "CREATE TABLE PARAMETER_ITEM "
    SQL = SQL & "( "
    SQL = SQL & "PARAMETER_ITEM_ID        ID_TYPE NOT NULL, "
    SQL = SQL & "PARAMETER_ID        ID_TYPE NOT NULL, "
    SQL = SQL & "PROCESS_ID           ID_TYPE NOT NULL, "
    SQL = SQL & "SELECT_FLAG           FLAG_TYPE, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
    SQL = SQL & ") "
    m_Conn.Execute (SQL)

  SQL = "CREATE GENERATOR PARAMETER_ITEM_SEQ "
   m_Conn.Execute (SQL)

 SQL = "ALTER TABLE PARAMETER_ITEM ADD CONSTRAINT PARAMETER_ITEM_ID_PK PRIMARY KEY (PARAMETER_ITEM_ID) "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE PARAMETER_ITEM ADD CONSTRAINT PARAMETER_ITEM_PARAMETER_FK FOREIGN KEY (PARAMETER_ID) REFERENCES PARAMETER_PROCESS "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE PARAMETER_ITEM ADD CONSTRAINT PARAMETER_ITEM_PROCESS_FK FOREIGN KEY (PROCESS_ID) REFERENCES PROCESS "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_17_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_18_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_18_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

    SQL = "CREATE TABLE JOB_PARAMETER "
    SQL = SQL & "( "
    SQL = SQL & "JOB_PARAMETER_ID        ID_TYPE    NOT NULL, "
    SQL = SQL & "JOB_ID              ID_TYPE    NOT NULL, "
    SQL = SQL & "PARAMETER_PROCESS_ID        ID_TYPE    NOT NULL, "
    SQL = SQL & "JOB_PARAMETER_DESC             DESC_TYPE, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE  NOT NULL "
    SQL = SQL & ") "

    m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR JOB_PARAMETER_SEQ "
   m_Conn.Execute (SQL)

 SQL = "ALTER TABLE JOB_PARAMETER ADD CONSTRAINT JOB_PARAMETER_ID_PK PRIMARY KEY (JOB_PARAMETER_ID) "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE JOB_PARAMETER ADD CONSTRAINT PARAMETER_PROCESS_JOB_ID_FK FOREIGN KEY (JOB_ID) REFERENCES JOB "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE JOB_PARAMETER ADD CONSTRAINT PARAMETER_PROCESS_ID_FK FOREIGN KEY (PARAMETER_PROCESS_ID) REFERENCES PARAMETER_PROCESS "
   m_Conn.Execute (SQL)

   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_18_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_19_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_19_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE UNIT ADD PERIOD_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_19_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function
Public Function Patch_1_0_12_19_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_19_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)


   SQL = "CREATE GENERATOR EMP_CHILD_SEQ "
   m_Conn.Execute (SQL)




   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_19_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_20_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_20_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
    SQL = "CREATE TABLE FORMULA_VARIABLE "
    SQL = SQL & "( "
    SQL = SQL & "   FORMULA_VARIABLE_ID   ID_TYPE NOT NULL,"
    SQL = SQL & "   FORMULA_ID            ID_TYPE NOT NULL,"
    SQL = SQL & "   VARIABLE_ID           ID_TYPE NOT NULL,"
    SQL = SQL & "   VARIABLE_VALUE        MONEY_TYPE NOT NULL,"
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE  NOT NULL "
    SQL = SQL & ") "
    m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR FORMULA_VARIABLE_SEQ "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE FORMULA_VARIABLE ADD CONSTRAINT FORMULA_VARIABLE_ID_PK PRIMARY KEY (FORMULA_VARIABLE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA_VARIABLE ADD CONSTRAINT FORMULA_VARIABLE_FOM_ID_FK FOREIGN KEY (FORMULA_ID) REFERENCES FORMULA "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FORMULA_ITEM ADD AVG_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE FORMULA ADD RMC MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE FORMULA ADD PMC MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE FORMULA_TYPE ADD INTERMEDIAT_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR ESTIMATE_NUMBER_SEQ "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_20_seub = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function


Public Function Patch_1_0_12_20_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_20_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   
   SQL = "CREATE GENERATOR JOB_NUMBER_SEQ "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_20_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_21_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_21_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE DO_ITEM ADD DOLLAR MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE DO_ITEM ADD COUNTRY_CURRENCY2 ID_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE DO_ITEM ADD COUNTRY_CURRENCY1 ID_TYPE "
   m_Conn.Execute (SQL)

    SQL = "CREATE TABLE MEMO_BANK "
    SQL = SQL & "( "
    SQL = SQL & "MEMO_BANK_ID            ID_TYPE    NOT NULL, "
    SQL = SQL & "BILLING_DOC_ID     ID_TYPE    NOT NULL, "
    SQL = SQL & "MEMO_BANK_NO            CODE_TYPE    NOT NULL, "
    SQL = SQL & "DESCRIPTION        DESC_TYPE, "
     SQL = SQL & "MEMO_BANK_DATE          DATE_TYPE, "
      SQL = SQL & "COEFFICIENT        MONEY_TYPE, "
       SQL = SQL & "AMOUNT_THAI        MONEY_TYPE, "
        SQL = SQL & "AMOUNT_OTHER       MONEY_TYPE, "
         SQL = SQL & "TAX                MONEY_TYPE, "
    SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
    SQL = SQL & "MODIFY_BY ID_TYPE  NOT NULL "
    SQL = SQL & ") "

    m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR MEMO_BANK_SEQ "
   m_Conn.Execute (SQL)

 SQL = "ALTER TABLE MEMO_BANK ADD CONSTRAINT MEMO_BANK_ID_PK PRIMARY KEY (MEMO_BANK_ID) "
   m_Conn.Execute (SQL)
 SQL = "ALTER TABLE MEMO_BANK ADD CONSTRAINT MEMO_BANK_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_21_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_22_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_22_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE MEMO_BANK ADD EXCHANGE_DATE DATE_TYPE "
   m_Conn.Execute (SQL)

   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_22_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function


Public Function Patch_1_0_12_21_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "1_0_12_21_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
               
   SQL = "CREATE TABLE BANK"
   SQL = SQL & "("
   SQL = SQL & "   BANK_ID      ID_TYPE NOT NULL,"
   SQL = SQL & "   BANK_NO          CODE_TYPE NOT NULL,"
   SQL = SQL & "   BANK_NAME         NAME_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_BY             ID_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_BY ID_TYPE NOT NULL"
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE BANK ADD CONSTRAINT BANK_ID_PK PRIMARY KEY (BANK_ID) "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE BALANCE_ACCUM ADD CONSTRAINT BALANCE_ACCUM_ID_PK PRIMARY KEY (BALANCE_ACCUM_ID) "
   m_Conn.Execute (SQL)
            
   SQL = "CREATE GENERATOR BANK_SEQ "
   m_Conn.Execute (SQL)
            
   
   SQL = "CREATE TABLE BANK_BRANCH"
   SQL = SQL & "("
   SQL = SQL & "   BBRANCH_ID      ID_TYPE NOT NULL,"
   SQL = SQL & "   BBRANCH_NO          CODE_TYPE NOT NULL,"
   SQL = SQL & "   BBRANCH_NAME         NAME_TYPE NOT NULL,"
   SQL = SQL & "   BANK_ID      ID_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_BY             ID_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_BY ID_TYPE NOT NULL"
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BANK_BRANCH ADD CONSTRAINT BANK_BRANCH_ID_PK PRIMARY KEY (BBRANCH_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BANK_BRANCH ADD CONSTRAINT BANK_BRANCH_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR BBRANCH_SEQ "
   m_Conn.Execute (SQL)
   '====
   
   SQL = "CREATE TABLE PAYMENT"
   SQL = SQL & "("
   SQL = SQL & "      PAYMENT_ID         ID_TYPE NOT NULL,"
   SQL = SQL & "      PAYMENT_NO         CODE_TYPE NOT NULL,"
   SQL = SQL & "      PAYMENT_DATE       NAME_TYPE NOT NULL,"
   SQL = SQL & "      TO_BANK_ID         ID_TYPE,"
   SQL = SQL & "      TO_BANK_BRANCH     ID_TYPE,"
   SQL = SQL & "      ACCOUNT_NO         CODE_TYPE,"
   SQL = SQL & "      COMMIT_FLAG        FLAG_TYPE,"
   SQL = SQL & "      INTERNAL_FLAG        FLAG_TYPE,"
   SQL = SQL & "      TX_TYPE            CODE_TYPE,"
   SQL = SQL & "   CREATE_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_BY             ID_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_BY ID_TYPE NOT NULL"
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_ID_PK PRIMARY KEY (PAYMENT_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_BANK_ID_FK FOREIGN KEY (TO_BANK_ID) REFERENCES BANK "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_BBRANCH_ID_FK FOREIGN KEY (TO_BANK_BRANCH) REFERENCES BANK_BRANCH "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR PAYMENT_SEQ "
   m_Conn.Execute (SQL)
               
   SQL = "CREATE TABLE PAYMENT_ITEM"
   SQL = SQL & "("
   SQL = SQL & "   PAYMENT_ITEM_ID    ID_TYPE NOT NULL,"
   SQL = SQL & "   PAYMENT_ID         ID_TYPE NOT NULL,"
   SQL = SQL & "   PAYMENT_TYPE       ID_TYPE,"
   SQL = SQL & "   CHECK_NO           CODE_TYPE,"
   SQL = SQL & "   BANK_ID            ID_TYPE,"
   SQL = SQL & "   BANK_BRANCH        ID_TYPE,"
   SQL = SQL & "   BANK_NOTE          DESC_TYPE,"
   SQL = SQL & "   CREATE_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   CREATE_BY             ID_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_DATE           DATE_TYPE NOT NULL,"
   SQL = SQL & "   MODIFY_BY ID_TYPE NOT NULL"
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT_ITEM ADD CONSTRAINT PAYMENT_ITEM_ID_PK PRIMARY KEY (PAYMENT_ITEM_ID) "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE PAYMENT_ITEM ADD CONSTRAINT PAYMENT_ITEM_PMT_ID_FK FOREIGN KEY (PAYMENT_ID) REFERENCES PAYMENT "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE PAYMENT_ITEM ADD CONSTRAINT PAYMENT_ITEM_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK "
   m_Conn.Execute (SQL)
   SQL = "ALTER TABLE PAYMENT_ITEM ADD CONSTRAINT PAYMENT_ITEM_BBANK_ID_FK FOREIGN KEY (BANK_BRANCH) REFERENCES BANK_BRANCH "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR PAYMENT_ITEM_SEQ "
   m_Conn.Execute (SQL)
   '===
   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_21_seub = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_22_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "1_0_12_22_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
               
   SQL = "ALTER TABLE PAYMENT ADD ACCEPT_BY ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_ACCEPT_BY_FK FOREIGN KEY (ACCEPT_BY) REFERENCES EMPLOYEE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD TOTAL_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT_ITEM ADD PAY_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   '===
   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_22_seub = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_23_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "1_0_12_23_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
               
   SQL = "CREATE TABLE JOB_VERIFY "
   SQL = SQL & "( "
   SQL = SQL & "JOB_VERIFY_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "JOB_ID           ID_TYPE NOT NULL, "
   SQL = SQL & "PART_ITEM_ID          ID_TYPE NOT NULL, "
   SQL = SQL & "NOTE          DESC_TYPE, "
   SQL = SQL & "VERIFY_FLAG          FLAG_TYPE, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
               
   SQL = "CREATE GENERATOR JOB_VERIFY_SEQ "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_VERIFY ADD CONSTRAINT JOB_VERIFY_ID_PK PRIMARY KEY (JOB_VERIFY_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_VERIFY ADD CONSTRAINT JOB_VERIFY_JOB_ID_FK FOREIGN KEY (JOB_ID) REFERENCES JOB "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE JOB_VERIFY ADD CONSTRAINT JOB_VERIFY_PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
   
   '===
   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_23_seub = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_24_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "1_0_12_24_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                              
   SQL = "ALTER TABLE BILLING_DOC ADD PAYMENT_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD BANK_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD BBRANCH_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD CHECK_NO CODE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD CHECK_DATE DATE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD CONSTRAINT BILLING_DOC_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD CONSTRAINT BILLING_DOC_BBRANCH_ID_FK FOREIGN KEY (BBRANCH_ID) REFERENCES BANK_BRANCH "
   m_Conn.Execute (SQL)
   
   '===
   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_24_seub = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_25_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_25_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   
   SQL = "ALTER TABLE BILLING_DOC ADD VADILITY DATE_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE BILLING_DOC ADD DELIVERY DATE_TYPE"
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD PAYMENT DATE_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_25_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_26_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_26_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE BILLING_DOC ADD PAYMENT_DESC DESC_TYPE "
   m_Conn.Execute (SQL)
     
  SQL = "ALTER TABLE BILLING_DOC ADD SHIPMENT DATE_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE BILLING_DOC ADD REFER_INV DESC_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD PACKING_OF DESC_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD SHIP_NAME DATE_TYPE "
   m_Conn.Execute (SQL)
   
 SQL = "ALTER TABLE BILLING_DOC ADD SHIPPING_MARKS DATE_TYPE "
   m_Conn.Execute (SQL)


   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_26_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_27_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_27_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   
   SQL = "ALTER TABLE BILLING_DOC DROP SHIP_NAME "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC DROP SHIPPING_MARKS "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD SHIP_NAME DESC_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD SHIPPING_MARKS NAME_TYPE "
   m_Conn.Execute (SQL)
  
   SQL = "ALTER TABLE BILLING_DOC ADD SHIPON_DATE DATE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PKGLST_ITEM ADD SET_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_27_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_25_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "1_0_12_25_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                                 
   SQL = "UPDATE BILLING_DOC BD SET TOTAL_PRICE ="
   SQL = SQL & "("
   SQL = SQL & "   SELECT SUM(DI.TOTAL_PRICE) FROM DO_ITEM DI"
   SQL = SQL & "   WHERE Di.DO_ID = Bd.BILLING_DOC_ID"
   SQL = SQL & ")"
   SQL = SQL & "WHERE ((SELECT COUNT(*) FROM DO_ITEM DI WHERE (DI.DO_ID = BD.BILLING_DOC_ID)) > 0)"
   m_Conn.Execute (SQL)
   '===
   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_25_seub = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_28_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_28_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE CURRENCY_EX "
   SQL = SQL & "( "
   SQL = SQL & "CURRENCY_EX_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "EXCHANGE_DATE          DATE_TYPE NOT NULL, "
   SQL = SQL & "US      MONEY_TYPE , "
   SQL = SQL & "EURO      MONEY_TYPE , "
   SQL = SQL & "YEN      MONEY_TYPE , "
   SQL = SQL & "SS      MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR CURRENCY_EX_SEQ "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CURRENCY_EX ADD CONSTRAINT CURRENCY_EX_ID_PK PRIMARY KEY (CURRENCY_EX_ID) "
   m_Conn.Execute (SQL)
   
    m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_28_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_29_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_29_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE MEMO_BANK ADD UNIT ID_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_29_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_30_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_30_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE DO_ITEM ADD QTYP MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE DO_ITEM ADD PACK MONEY_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_30_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_30_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_30_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE GENERATOR QUOATATION_NUMBER_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_30_seub = True
End Function

Public Function Patch_1_0_12_31_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_31_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE DO_ITEM ADD DISCOUNT_PERCENT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD REF STRING_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD CREDIT MONEY_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_31_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function
Public Function Patch_1_0_12_32_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_32_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE MEMO_BANK ADD TICKET_TYPE CODE_TYPE "
   m_Conn.Execute (SQL)
         
    SQL = "ALTER TABLE MEMO_BANK ADD INVOICE_NO CODE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD CURRENCY_OTHER CODE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD RATIO MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD COST_BAHT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD TAX_PERCENT MONEY_TYPE "
   m_Conn.Execute (SQL)
         
    SQL = "ALTER TABLE MEMO_BANK ADD TAX_IN MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD VAT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_BANK ADD PAID_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_32_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function
Public Function Patch_1_0_12_33_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_33_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE GENERATOR PKGLST_NUMBER_SEQ "
   m_Conn.Execute (SQL)
    
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_33_jill = True
   Exit Function
   
ErrorHandler:
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_1_0_12_41_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_41_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE EXTRACT_ITEM "
   SQL = SQL & "( "
   SQL = SQL & "EXTRACT_ITEM_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "QUANTITY_EXTRACT_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "PART_ITEM_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "TOTAL_AMT      MONEY_TYPE NOT NULL, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR EXTRACT_ITEM_SEQ "
   m_Conn.Execute (SQL)
  
   SQL = "ALTER TABLE EXTRACT_ITEM ADD CONSTRAINT EXTRACT_ITEM_ID_PK PRIMARY KEY (EXTRACT_ITEM_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EXTRACT_ITEM ADD CONSTRAINT EXTRACT_ITEM_QTE_ID_FK FOREIGN KEY (QUANTITY_EXTRACT_ID) REFERENCES QUANTITY_EXTRACT "
   m_Conn.Execute (SQL)
      
   SQL = "ALTER TABLE EXTRACT_ITEM ADD CONSTRAINT EXTRACT_ITEM_PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)


   SQL = "ALTER TABLE FORMULA_ITEM ADD REAL_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "UPDATE FORMULA_ITEM SET REAL_AMOUNT = ITEM_PERCENT "
   m_Conn.Execute (SQL)

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_41_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_42_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_42_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE GENERATOR EXPORT_NUMBER_SEQ "
   m_Conn.Execute (SQL)
  
   SQL = "CREATE GENERATOR TRANSFER_NUMBER_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_42_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_77_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_77_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE BILLING_DOC ADD TEMP_DO_NO CODE_TYPE "
   m_Conn.Execute (SQL)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_77_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_78_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_78_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE HGROUP_ITEM DROP CONSTRAINT HGROUP_ITEM_HGROUP_ID_FK "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE HGROUP_ITEM DROP HOUSE_GROUP_ID "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE HGROUP_ITEM ADD PART_GROUP_ID ID_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE HGROUP_ITEM ADD CONSTRAINT HGROUP_ITEM_PGROUP_ID_FK FOREIGN KEY (PART_GROUP_ID) REFERENCES PART_GROUP "
   m_Conn.Execute (SQL)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_78_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_79_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_79_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_79_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_80_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_80_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "CREATE TABLE COST_EXPENSE "
   SQL = SQL & "( "
   SQL = SQL & "COST_EXPENSE_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "COST_PRODUCTION_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "EXPENSE_TYPE      ID_TYPE NOT NULL, "
   SQL = SQL & "PACKAGE_TYPE      ID_TYPE, "
   SQL = SQL & "RATIO_TYPE      ID_TYPE, "
   SQL = SQL & "EXPENSE_AMOUNT      MONEY_TYPE, "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE COST_EXPENSE ADD CONSTRAINT COST_EXPENSE_ID_ID_PK PRIMARY KEY (COST_EXPENSE_ID) "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE COST_EXPENSE ADD CONSTRAINT COST_EXPENSE_CSTPRD_ID_FK FOREIGN KEY (COST_PRODUCTION_ID) REFERENCES COST_PRODUCTION "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE COST_EXPENSE ADD CONSTRAINT COST_EXPENSE_EXP_ID_FK FOREIGN KEY (EXPENSE_TYPE) REFERENCES PARAMETER_PROCESS "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR COST_EXPENSE_SEQ "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PART_ITEM ADD PARCEL_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD RAW_COST MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD EXPENSE_COST MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE COSTPRD_ITEM ADD RAW_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_80_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_82_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_82_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_82_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_83_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_83_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE JOB ADD FORMULA_ID ID_TYPE "
   m_Conn.Execute (SQL)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_83_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_85_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_85_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE RECEIPT_ITEM ADD PAID_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE RECEIPT_ITEM ADD DEBIT_CREDIT_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD PAID_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD DEBIT_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD CREDIT_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD DO_TOTAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD REVENUE_TOTAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD DOCUMENT_SUBTYPE ID_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD PAYMENT_ID ID_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD CONSTRAINT BILLING_DOC_PM_ID_FK FOREIGN KEY (PAYMENT_ID) REFERENCES PAYMENT "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD BANK_BRANCH_ID ID_TYPE "
   m_Conn.Execute (SQL)
        
   SQL = "ALTER TABLE BILLING_DOC ADD BANK_NOTE DESC_TYPE "
   m_Conn.Execute (SQL)
        
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_85_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_86_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_86_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE LOT_ITEM ADD TOTAL_NEW_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_86_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_88_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_88_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE LOT_ITEM ADD BAG_RETURN FLAG_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE INVENTORY_DOC ADD ADJUST_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE LOT_ITEM ADD ACTUAL_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE LOT_ITEM ADD ACTUAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE LOT_ITEM ADD CURRENT_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE LOT_ITEM ADD CURRENT_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE RECEIPT_ITEM ADD DRCR_REASON ID_TYPE "
   m_Conn.Execute (SQL)
                
   SQL = "ALTER TABLE RECEIPT_ITEM ADD CASH_DISCOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_88_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_89_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "1_0_12_89_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE CUSTOMER ADD EXP_CODE CODE_TYPE "
   m_Conn.Execute (SQL)
                
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_89_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_90_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_90_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "ALTER TABLE DO_ITEM ADD EXTRA_DISCOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
                
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "UPDATE PART_ITEM SET PARCEL_TYPE = 2 WHERE PART_TYPE = 21 "
   m_Conn.Execute (SQL)

   SQL = "UPDATE BILLING_DOC SET COMMIT_FLAG = 'Y' WHERE DOCUMENT_DATE <= '2006-02-28 23:5959' "
   m_Conn.Execute (SQL)

   Set Bd = New CBillingDoc
   Call glbDaily.PatchExtraDiscount(Bd, IsOK, False, glbErrorLog)
   Set Bd = Nothing
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_90_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_92_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_92_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
        
   SQL = "CREATE INDEX BD_CHECK_NO_IDX ON BILLING_DOC (CHECK_NO) "
   m_Conn.Execute (SQL)
                
   SQL = "CREATE INDEX BD_PMT_TYPE_IDX ON PAYMENT_ITEM (PAYMENT_TYPE) "
   m_Conn.Execute (SQL)
                
   SQL = "CREATE INDEX PMI_CHECK_NO_IDX ON PAYMENT_ITEM (CHECK_NO) "
   m_Conn.Execute (SQL)
                
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_92_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_93_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_93_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PAYMENT_ITEM ADD FEE_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
                                
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_93_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_94_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_94_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE LOT_ITEM ADD NEED_TOTAL_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
                                
   SQL = "ALTER TABLE LOT_ITEM ADD NEED_TOTAL_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD NEED_AVG_PRICE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_94_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_95_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_95_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PAYMENT_ITEM ADD POST_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
                                   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "UPDATE PAYMENT_ITEM SET POST_FLAG = 'Y' "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_95_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_96_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_96_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE LOT_ITEM ADD MANUAL_PRICE FLAG_TYPE "
   m_Conn.Execute (SQL)
                                   
   SQL = "ALTER TABLE LOT_ITEM ADD EXPENSE_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD CONSTRAINT LOT_ITEM_EXPENSE_TYPE_FK FOREIGN KEY (EXPENSE_TYPE) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "UPDATE LOT_ITEM SET MANUAL_PRICE = 'N' "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO DOCUMENT_PRIORITY (DOCUMENT_PRIORITY_ID, DOCUMENT_TYPE, AREA, PRIORITY1, PRIORITY2, CREATE_DATE, CREATE_BY, MODIFY_DATE, MODIFY_BY) VALUES (9, 22, 1, 3, 3, '2000', 1, '2000', 1) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO DOCUMENT_PRIORITY (DOCUMENT_PRIORITY_ID, DOCUMENT_TYPE, AREA, PRIORITY1, PRIORITY2, CREATE_DATE, CREATE_BY, MODIFY_DATE, MODIFY_BY) VALUES (10, 23, 1, 1, 1, '2000', 1, '2000', 1) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_96_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_97_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_97_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO DOCUMENT_PRIORITY (DOCUMENT_PRIORITY_ID, DOCUMENT_TYPE, AREA, PRIORITY1, PRIORITY2, CREATE_DATE, CREATE_BY, MODIFY_DATE, MODIFY_BY) VALUES (11, 4, 1, 999, 999, '2000', 1, '2000', 1) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_97_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_98_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_98_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE MASTER_REF ADD TEMP_ID1 ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MASTER_REF ADD TEMP_ID2 ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD BANK_ACCOUNT ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD CUSTOMER_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PAYMENT ADD CONSTRAINT PAYMENT_CUST_ID FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   Call glbDaily.PatchBankAccount(IsOK, False, glbErrorLog)
   
   SQL = "UPDATE PAYMENT PM SET BANK_ACCOUNT = (SELECT KEY_ID FROM MASTER_REF MR WHERE (MR.KEY_NAME = PM.ACCOUNT_NO) AND (MR.TEMP_ID1 = PM.TO_BANK_ID) AND (MR.TEMP_ID2 = PM.TO_BANK_BRANCH) AND (MR.MASTER_AREA = 3)) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_98_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_1_0_12_99_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim Bd As CBillingDoc
Dim IsOK As Boolean

   VersionStr = "1_0_12_99_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PAYMENT ADD RECEIPT_NO CODE_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_1_0_12_99_seub = True
   Exit Function
   
'ErrorHandler:
'   If HasBegin Then
'      m_Conn.RollbackTrans
'   End If
End Function

Public Function Patch_2006_09_21_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_21_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "CREATE TABLE  CASH_DOC "
   SQL = SQL & "( "
   SQL = SQL & "CASH_DOC_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "DOCUMENT_DATE           DATE_TYPE , "
   SQL = SQL & "BANK_BRANCH           ID_TYPE , "
   SQL = SQL & "BANK_ID           ID_TYPE , "
   SQL = SQL & "BANK_ACCOUNT           ID_TYPE , "
   SQL = SQL & "ENTERPRISE_ID           ID_TYPE , "
   SQL = SQL & "DOCUMENT_NO           CODE_TYPE , "
   SQL = SQL & "DOCUMENT_TYPE           ID_TYPE , "
   SQL = SQL & "EMP_ID           ID_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_ID_PK PRIMARY KEY (CASH_DOC_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_BBRANCH_FK FOREIGN KEY (BANK_BRANCH) REFERENCES BANK_BRANCH  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_BNK_ACCOUNT_FK FOREIGN KEY (BANK_ACCOUNT) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_EMP_ID_FK FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE TABLE  CHEQUE "
   SQL = SQL & "( "
   SQL = SQL & "CHEQUE_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "CHEQUE_NO           CODE_TYPE , "
   SQL = SQL & "CHEQUE_DATE           DATE_TYPE , "
   SQL = SQL & "EFFECTIVE_DATE           DATE_TYPE , "
   SQL = SQL & "CHEQUE_TYPE           ID_TYPE , "
   SQL = SQL & "CHEQUE_STATUS           ID_TYPE , "
   SQL = SQL & "BANK_ID           ID_TYPE , "
   SQL = SQL & "BANK_BRANCH           ID_TYPE , "
   SQL = SQL & "ENTERPRISE_ID           ID_TYPE , "
   SQL = SQL & "DIRECTION           ID_TYPE , "
   SQL = SQL & "CHEQUE_AMOUNT           MONEY_TYPE , "
   SQL = SQL & "APAR_ID           ID_TYPE , "
   SQL = SQL & "BANK_FLAG           FLAG_TYPE , "
   SQL = SQL & "TX_DATE           DATE_TYPE , "
   SQL = SQL & "TX_NO CODE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_ID_PK PRIMARY KEY (CHEQUE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_BANK_BRANCH_FK FOREIGN KEY (BANK_BRANCH) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_CHEQUE_TYPE_FK FOREIGN KEY (CHEQUE_TYPE) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_ENTERPRISE_ID_FK FOREIGN KEY (ENTERPRISE_ID) REFERENCES ENTERPRISE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_APAR_ID_FK FOREIGN KEY (APAR_ID) REFERENCES CUSTOMER  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE TABLE CASH_TRAN "
   SQL = SQL & "( "
   SQL = SQL & "CASH_TRAN_ID      ID_TYPE NOT NULL, "
    SQL = SQL & "BILLING_DOC_ID           ID_TYPE , "
   SQL = SQL & "CHECK_ID           ID_TYPE , "
   SQL = SQL & "AMOUNT           MONEY_TYPE , "
   SQL = SQL & "BANK_ID           ID_TYPE , "
    SQL = SQL & "BANK_BRANCH           ID_TYPE , "
   SQL = SQL & "ENTERPRISE_ID           ID_TYPE , "
   SQL = SQL & "TX_TYPE           CODE_TYPE , "
   SQL = SQL & "PAYMENT_TYPE           ID_TYPE , "
   SQL = SQL & "BANK_ACCOUNT           ID_TYPE , "
   SQL = SQL & "CASH_DOC_ID           ID_TYPE , "
   SQL = SQL & "FEE_AMOUNT           MONEY_TYPE , "
   SQL = SQL & "NET_AMOUNT           MONEY_TYPE , "
   SQL = SQL & "TX_DATE           DATE_TYPE , "
   SQL = SQL & "TX_NO           CODE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_ID_PK PRIMARY KEY (CASH_TRAN_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_BANK_AMOUNT_FK FOREIGN KEY (BANK_ACCOUNT) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_BILLING_DOC_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_CHEQUE_FK FOREIGN KEY (CHECK_ID) REFERENCES CHEQUE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_CASH_DOC_FK FOREIGN KEY (CASH_DOC_ID) REFERENCES CASH_DOC  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CHEQUE_SEQ "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR CASH_DOC_SEQ "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR CASH_TRAN_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_21_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_09_22_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_22_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE CASH_TRAN ADD CUSTOMER_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_22_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_09_23_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_23_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_23_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_09_25_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_25_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " ALTER TABLE CASH_DOC ADD  CUSTOMER_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
  SQL = " ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_25_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2006_09_25_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_25_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " ALTER TABLE CHEQUE ADD  POST_FLAG FLAG_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_25_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_09_25_1_seub() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_25_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE DO_ITEM ADD TRANSFER_WAGE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE DO_ITEM ADD STD_TRANSFER_CHARGE MONEY_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE DOCUMENT_PRIORITY ADD TX_TYPE CODE_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE CUSTOMER_GRADE ADD MANUAL_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_25_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2006_09_26_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_26_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " UPDATE CHEQUE SET POST_FLAG = 'N' "
   m_Conn.Execute (SQL)
    
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_26_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_09_26_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_26_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "CREATE TABLE  CASH_DOC_POST "
   SQL = SQL & "( "
   SQL = SQL & "CASH_DOC_POST_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "CASH_DOC_ID           ID_TYPE , "
   SQL = SQL & "BANK_BRANCH           ID_TYPE , "
   SQL = SQL & "BANK_ID           ID_TYPE , "
   SQL = SQL & "CHEQUE_ID           ID_TYPE , "
   SQL = SQL & "CHEQUE_AMOUNT           MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_ID_PK PRIMARY KEY (CASH_DOC_POST_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_CASH_DOC_ID_FK FOREIGN KEY (CASH_DOC_ID) REFERENCES CASH_DOC  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_BBRANCH_FK FOREIGN KEY (BANK_BRANCH) REFERENCES BANK_BRANCH  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_CHEQUE_FK FOREIGN KEY (CHEQUE_ID) REFERENCES CHEQUE  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CASH_DOC_POST_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_26_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2006_09_26_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_26_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE CHEQUE DROP CONSTRAINT CHEQUE_BANK_BRANCH_FK  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE DROP CONSTRAINT CHEQUE_BANK_ID_FK "
   m_Conn.Execute (SQL)
      
    SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_BANK_BRANCH_FK FOREIGN KEY (BANK_BRANCH) REFERENCES BANK_BRANCH  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_BANK_ID_FK FOREIGN KEY (BANK_ID) REFERENCES BANK  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_26_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2006_09_27_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_09_27_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE BILLING_DOC ADD TOTAL_RCP MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_09_27_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_02_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_02_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "CREATE TABLE  COST_RAW "
   SQL = SQL & "( "
   SQL = SQL & "COST_RAW_ID      ID_TYPE NOT NULL, "
   SQL = SQL & "COST_EXPENSE_ID           ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID           ID_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE COST_RAW ADD CONSTRAINT COST_RAW_PK PRIMARY KEY (COST_RAW_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE COST_RAW ADD CONSTRAINT COST_RAW_EXP_FK FOREIGN KEY (COST_EXPENSE_ID) REFERENCES COST_EXPENSE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE COST_RAW ADD CONSTRAINT COST_RAW_PART_ITEM_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR COST_RAW_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_02_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_03_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_03_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
     
   SQL = "ALTER TABLE QUANTITY_EXTRACT ADD PROCESS_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE QUANTITY_EXTRACT ADD AREA ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EXTRACT_ITEM ADD STD_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "DELETE FROM EXTRACT_ITEM "
   m_Conn.Execute (SQL)
   
   SQL = "DELETE FROM QUANTITY_EXTRACT "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_03_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_04_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_04_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "CREATE TABLE  PRTITEM_SET  "
   SQL = SQL & "( "
   SQL = SQL & "PRTITEM_SET_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "MASTER_REF_ID                   ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PRTITEM_SET  ADD CONSTRAINT PRTITEM_SET_PK  PRIMARY KEY (PRTITEM_SET_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE PRTITEM_SET  ADD CONSTRAINT PRTITEM_SET_MR_FK  FOREIGN KEY (MASTER_REF_ID) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE PRTITEM_SET  ADD CONSTRAINT PRTITEM_SET_PART_ITEM_FK  FOREIGN KEY (PART_ITEM_ID ) REFERENCES PART_ITEM  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR PRTITEM_SET_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_04_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_06_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_06_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  
   SQL = " ALTER TABLE RECEIPT_ITEM ADD PART_ITEM_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD RETURN_AMOUNT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD LOCATION_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD PART_TYPE ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD RETURN_TOTAL_PRICE MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD RETURN_AVG_PRICE MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD AVG_WEIGHT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD FEATURE_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD RETURN_DISCOUNT_AMOUNT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD CONFIG_CODE CODE_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD DISPLAY_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD COUNTRY_CURRENCY1 ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD COUNTRY_CURRENCY2 ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD WEIGHT_PER_PACK MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD PACK_AMOUNT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD PRICE_PER_PACK MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD DISCOUNT_PER_PACK MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD MANUAL_FLAG FLAG_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD MANUAL_CODE CODE_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD MANUAL_NAME CODE_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD RATE_TYPE ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD TRANSFER_WAGE MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD STD_TRANSFER_CHARGE MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE RECEIPT_ITEM ADD ITEM_DESC DESC_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_06_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_09_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_09_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE RECEIPT_ITEM ADD LINK_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_09_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_09_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_09_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE RECEIPT_ITEM ADD AVG_PRICE MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_09_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_12_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_12_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE TABLE  SALE_ORDER  "
   SQL = SQL & "( "
   SQL = SQL & "SALE_ORDER_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "DO_ID                   ID_TYPE NOT NULL, "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "LOCATION_ID                    ID_TYPE , "
   SQL = SQL & "ITEM_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "TOTAL_WEIGHT                    MONEY_TYPE , "
   SQL = SQL & "AVG_WEIGHT                    MONEY_TYPE , "
   SQL = SQL & "TOTAL_PRICE                    MONEY_TYPE , "
   SQL = SQL & "AVG_PRICE                    MONEY_TYPE , "
   SQL = SQL & "GUI_ID                    ID_TYPE , "
   SQL = SQL & "PIG_STATUS                    ID_TYPE , "
   SQL = SQL & "LINK_ID                    ID_TYPE , "
   SQL = SQL & "CONFIG_CODE                    CODE_TYPE , "
   SQL = SQL & "SOC_ID                    ID_TYPE , "
   SQL = SQL & "FEATURE_ID                    ID_TYPE , "
   SQL = SQL & "ITEM_DESC                    DESC_TYPE , "
   SQL = SQL & "DEPOSIT_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "DISPLAY_ID                    ID_TYPE , "
   SQL = SQL & "PO_ID                    ID_TYPE , "
   SQL = SQL & "PO_NO                    CODE_TYPE , "
   SQL = SQL & "FROM_PERIOD                    DATE_TYPE , "
   SQL = SQL & "TO_PERIOD                    DATE_TYPE , "
   SQL = SQL & "DOLLAR                    MONEY_TYPE , "
   SQL = SQL & "COUNTRY_CURRENCY2                    ID_TYPE , "
   SQL = SQL & "COUNTRY_CURRENCY1                    ID_TYPE , "
   SQL = SQL & "QTYP                    MONEY_TYPE , "
   SQL = SQL & "PACK                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_PERCENT                    MONEY_TYPE , "
   SQL = SQL & "WEIGHT_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "PACK_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "PRICE_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "MANUAL_FLAG                    FLAG_TYPE , "
   SQL = SQL & "MANUAL_CODE                    CODE_TYPE , "
   SQL = SQL & "MANUAL_NAME                    CODE_TYPE , "
   SQL = SQL & "RATE_TYPE                    ID_TYPE , "
   SQL = SQL & "EXTRA_DISCOUNT                    MONEY_TYPE , "
   SQL = SQL & "TRANSFER_WAGE                    MONEY_TYPE , "
   SQL = SQL & "STD_TRANSFER_CHARGE                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SALE_ORDER  ADD CONSTRAINT SALE_ORDER_PK  PRIMARY KEY (SALE_ORDER_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE SALE_ORDER  ADD CONSTRAINT SALE_ORDER_DO_ID_FK  FOREIGN KEY (DO_ID) REFERENCES BILLING_DOC  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE SALE_ORDER  ADD CONSTRAINT SALE_ORDER_PIG_STATUS_ID_FK  FOREIGN KEY (PIG_STATUS ) REFERENCES PRODUCT_STATUS  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR SALE_ORDER_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_12_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_13_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_13_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE TABLE  CONFIG_DOC  "
   SQL = SQL & "( "
   SQL = SQL & "CONFIG_DOC_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "CONFIG_DOC_TYPE                    ID_TYPE , "
   SQL = SQL & "ENTERPRISE_ID             ID_TYPE , "
   SQL = SQL & "PREFIX                    CODE_TYPE , "
   SQL = SQL & "CODE1                    CODE_TYPE , "
   SQL = SQL & "YEAR_TYPE                    ID_TYPE , "
   SQL = SQL & "CODE2                    CODE_TYPE , "
   SQL = SQL & "MONTH_TYPE                    ID_TYPE , "
   SQL = SQL & "CODE3                    CODE_TYPE , "
   SQL = SQL & "DIGIT_AMOUNT                    ID_TYPE , "
   SQL = SQL & "RUNNING_NO                    ID_TYPE , "
   SQL = SQL & "LAST_NO                    CODE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CONFIG_DOC  ADD CONSTRAINT CONFIG_DOC_PK  PRIMARY KEY (CONFIG_DOC_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CONFIG_DOC_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_13_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_16_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_16_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE BILLING_DOC ADD RUNNING_NO ID_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_16_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_18_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_18_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE CUSTOMER ADD CREDIT_LIMIT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_18_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_19_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_19_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
     
   m_Conn.BeginTrans
   HasBegin = True
   
   Call glbDaily.PatchDocumentPriority
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_19_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_19_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_19_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE TABLE  CUSTOMER_PICTURE "
   SQL = SQL & "( "
   SQL = SQL & "CUSTOMER_PICTURE_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "CUSTOMER_ID                    ID_TYPE , "
   SQL = SQL & "CUSTOMER_PICTURE_TYPE             ID_TYPE , "
   SQL = SQL & "CUSTOMER_PICTURE_PATH                   DESC_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_PICTURE  ADD CONSTRAINT CUSTOMER_PICTURE_PK  PRIMARY KEY (CUSTOMER_PICTURE_ID) "
   m_Conn.Execute (SQL)
      
   SQL = " ALTER TABLE CUSTOMER_PICTURE  ADD CONSTRAINT CUSTOMER_PICTURE_CUSTOMER_ID_FK  FOREIGN KEY (CUSTOMER_ID ) REFERENCES CUSTOMER  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CUSTOMER_PICTURE_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_19_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_20_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_20_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " ALTER TABLE BILLING_DOC ADD AGREEMENT_DATA DESC_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE BILLING_DOC ADD AGREEMENT_FINANCE DESC_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_20_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_25_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_25_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " ALTER TABLE BILLING_DOC ADD OLD_CREDIT_AMOUNT MONEY_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_25_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_10_25_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_10_25_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE GENERATOR PICTURE_FILE_SEQ "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_10_25_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_11_02_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_11_02_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE UC_RATE ADD LOG_RATE_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_11_02_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_11_15_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_11_15_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE TABLE  MEMO_NOTE  "
   SQL = SQL & "( "
   SQL = SQL & "MEMO_NOTE_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "MEMO_NOTE_DATE_CREATE                    DATE_TYPE , "
   SQL = SQL & "MEMO_NOTE_DATE_FINISH                    DATE_TYPE , "
   SQL = SQL & "MEMO_NOTE_DATE_FINISH_REAL                    DATE_TYPE , "
   SQL = SQL & "MEMO_NOTE_CREATE_BY                    ID_TYPE , "
   SQL = SQL & "MEMO_NOTE_CREATE_TO                    ID_TYPE , "
   SQL = SQL & "MEMO_NOTE_WARN                    FLAG_TYPE , "
   SQL = SQL & "MEMO_NOTE_TYPE                    ID_TYPE , "
   SQL = SQL & "MEMO_NOTE_STATUS                    ID_TYPE , "
   SQL = SQL & "ENTERPRISE_ID             ID_TYPE , "
   SQL = SQL & "MEMO_NOTE_SUBJECT                    DESC_TYPE , "
   SQL = SQL & "MEMO_NOTE_DESCRIPTION                    DESC_TYPE , "
   SQL = SQL & "MEMO_NOTE_RESOLUTION                    DESC_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_ID_PK  PRIMARY KEY (MEMO_NOTE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_CREATE_BY_FK  FOREIGN KEY (MEMO_NOTE_CREATE_BY ) REFERENCES EMPLOYEE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_CREATE_TO_FK  FOREIGN KEY (MEMO_NOTE_CREATE_TO ) REFERENCES EMPLOYEE  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_TYPE_FK  FOREIGN KEY (MEMO_NOTE_TYPE) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_STATUS_FK  FOREIGN KEY (MEMO_NOTE_STATUS) REFERENCES MASTER_REF  "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR MEMO_NOTE_SEQ "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_11_15_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2006_11_19_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2006_11_19_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " UPDATE MEMO_NOTE SET MEMO_NOTE_CREATE_BY = NULL "
   m_Conn.Execute (SQL)
   
   SQL = " UPDATE MEMO_NOTE SET MEMO_NOTE_CREATE_TO = NULL "
   m_Conn.Execute (SQL)
   
  SQL = " ALTER TABLE MEMO_NOTE DROP CONSTRAINT MEMO_NOTE_CREATE_BY_FK "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE DROP CONSTRAINT MEMO_NOTE_CREATE_TO_FK "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE USER_ACCOUNT  ADD CONSTRAINT USER_ID_PK  PRIMARY KEY (USER_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_CREATE_BY_FK  FOREIGN KEY (MEMO_NOTE_CREATE_BY ) REFERENCES USER_ACCOUNT  "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE MEMO_NOTE  ADD CONSTRAINT MEMO_NOTE_CREATE_TO_FK  FOREIGN KEY (MEMO_NOTE_CREATE_TO ) REFERENCES USER_ACCOUNT  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_11_19_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2006_11_21_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2006_11_21_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = " UPDATE RECEIPT_ITEM SET DEBIT_CREDIT_AMOUNT = RETURN_TOTAL_PRICE - RETURN_DISCOUNT_AMOUNT "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2006_11_21_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_01_22_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_01_22_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE BILLING_DOC ADD ENTRY_DATE DATE_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE BILLING_DOC ADD EXIT_DATE DATE_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_01_22_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_01_23_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_01_23_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
     
   m_Conn.BeginTrans
   HasBegin = True
   
   Call glbDaily.PatchDocumentPriority
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_01_23_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_01_25_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_01_25_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
  SQL = "CREATE TABLE  CSTITEM_RAW  "
   SQL = SQL & "( "
   SQL = SQL & "CSTITEM_RAW_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "COST_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "ITEM_COST                    MONEY_TYPE , "
   SQL = SQL & "ITEM_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CSTITEM_RAW ADD CONSTRAINT CSTITEM_RAW_ID_PK PRIMARY KEY (CSTITEM_RAW_ID) "
   m_Conn.Execute (SQL)
   
   SQL = " ALTER TABLE CSTITEM_RAW ADD CONSTRAINT CSTITEM_RAW_CSTITM_ID_FK FOREIGN KEY (COST_ITEM_ID) REFERENCES COST_ITEM  "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CSTITEM_RAW ADD CONSTRAINT CSTITEM_RAW_PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CSTITEM_RAW_SEQ  "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_01_25_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_02_01_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_01_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE PART_ITEM ADD MAXIMUM_ALLOW MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_01_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_02_07_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_07_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE LOT_ITEM ADD AUTO_PRICE FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
  SQL = "UPDATE LOT_ITEM SET AUTO_PRICE = 'N' "
   m_Conn.Execute (SQL)
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_07_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_06_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_06_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE INVENTORY_DOC ADD CREDIT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_06_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_06_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_06_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE LOT_ITEM ADD ITEM_DESC_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD CONSTRAINT LOT_ITEM_DESC_ID_FK FOREIGN KEY (ITEM_DESC_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_06_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_07_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_07_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE INVENTORY_DOC ADD PR_NO CODE_TYPE "   '      PO  
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_07_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_07_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_07_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "UPDATE PART_ITEM PI SET PI.PART_TYPE = 32 WHERE PI.PART_TYPE IN (SELECT DISTINCT PI1.PART_TYPE  FROM PART_ITEM  PI1 LEFT OUTER JOIN PART_TYPE PT ON  (PI1.PART_TYPE = PT.PART_TYPE_ID) WHERE  PT.PART_GROUP_ID = 18)  "   '
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_07_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_12_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_12_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
  SQL = "CREATE TABLE  EXPENSE_DETAIL  "
   SQL = SQL & "( "
   SQL = SQL & "EXPENSE_DETAIL_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "EXPENSE_DETAIL_TYPE                    ID_TYPE , "
   SQL = SQL & "EXPENSE_DETAIL_DESC                    DESC_TYPE , "
   SQL = SQL & "EXPENSE_DETAIL_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "EXPENSE_DETAIL_AVG                    MONEY_TYPE , "
   SQL = SQL & "EXPENSE_DETAIL_PRICE                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EXPENSE_DETAIL ADD CONSTRAINT EXPENSE_DETAIL_ID_PK PRIMARY KEY (EXPENSE_DETAIL_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR EXPENSE_DETAIL_SEQ  "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_12_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_13_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_13_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "CREATE TABLE  EXPENSE  "
   SQL = SQL & "( "
   SQL = SQL & "EXPENSE_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "EXPENSE_NO                    CODE_TYPE , "
   SQL = SQL & "EXPENSE_DESC                    DESC_TYPE , "
   SQL = SQL & "EXPENSE_DATE                    DATE_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EXPENSE ADD CONSTRAINT EXPENSE_ID_PK PRIMARY KEY (EXPENSE_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR EXPENSE_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_13_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_13_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_13_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "ALTER TABLE EXPENSE_DETAIL ADD EXPENSE_ID ID_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE EXPENSE_DETAIL ADD CONSTRAINT EXPENSE_DETAIL_EXPENSE_ID_FK FOREIGN KEY (EXPENSE_ID) REFERENCES EXPENSE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_13_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_13_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_02_13_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = "ALTER TABLE EXPENSE_DETAIL ADD CONSTRAINT EXPENSE_DETAIL_EXPENSE_TYPE_FK FOREIGN KEY (EXPENSE_DETAIL_TYPE) REFERENCES PARAMETER_PROCESS "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_13_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_02_19_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_02_19_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
  SQL = "CREATE TABLE  CUSTOMER_ACCOUNT_LIST "
   SQL = SQL & "( "
   SQL = SQL & "CUSTOMER_ACCOUNT_LIST_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "CUSTOMER_ID                    ID_TYPE , "
   SQL = SQL & "ACCOUNT_LIST_TYPE                    ID_TYPE , "
   SQL = SQL & "PART_GROUP_ID                    ID_TYPE , "
   SQL = SQL & "FEATURE_TYPE                    ID_TYPE , "
   SQL = SQL & "BANK_ACCOUNT_ID                    ID_TYPE , "
   SQL = SQL & "DEBIT_ID                    ID_TYPE , "
   SQL = SQL & "CREDIT_ID                    ID_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUSTOMER_ACCOUNT_LIST_ID_PK PRIMARY KEY (CUSTOMER_ACCOUNT_LIST_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_PART_GROUP_FK FOREIGN KEY (PART_GROUP_ID) REFERENCES PART_GROUP "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_FEATURE_FK FOREIGN KEY (FEATURE_TYPE) REFERENCES FEATURE_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_BANK_ACCOUNT_FK FOREIGN KEY (BANK_ACCOUNT_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_DEBIT_FK FOREIGN KEY (DEBIT_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_CREDIT_FK FOREIGN KEY (CREDIT_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CUSTOMER_ACCOUNT_LIST ADD CONSTRAINT CUS_ACC_LIST_CUSTOMER_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CUSTOMER_ACCOUNT_LIST_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_19_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
   
Public Function Patch_2007_02_23_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_02_23_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE JOB_INOUT ADD PARAM_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_02_23_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_02_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_03_02_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE MASTER_REF ADD MASTER_FLAG FLAG_TYPE "   '
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_01_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
   
Public Function Patch_2007_03_02_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_03_02_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "UPDATE MASTER_REF SET MASTER_FLAG = 'N' "   '
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_01_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
   
Public Function Patch_2007_03_13_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_13_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  SUP_ITEM "
   SQL = SQL & "( "
   SQL = SQL & "SUP_ITEM_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "DO_ID                    ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "LOCATION_ID                    ID_TYPE , "
   SQL = SQL & "ITEM_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "TOTAL_WEIGHT                    MONEY_TYPE , "
   SQL = SQL & "AVG_WEIGHT                    MONEY_TYPE , "
  SQL = SQL & "TOTAL_PRICE                    MONEY_TYPE , "
  SQL = SQL & "AVG_PRICE                    MONEY_TYPE , "
  SQL = SQL & "GUI_ID                    ID_TYPE , "
  SQL = SQL & "PIG_STATUS                    ID_TYPE , "
  SQL = SQL & "LINK_ID                    ID_TYPE , "
  SQL = SQL & "CONFIG_CODE                    CODE_TYPE , "
   SQL = SQL & "SOC_ID                    ID_TYPE , "
   SQL = SQL & "FEATURE_ID                    ID_TYPE , "
   SQL = SQL & "ITEM_DESC                    DESC_TYPE , "
   SQL = SQL & "DEPOSIT_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "DISPLAY_ID                    ID_TYPE , "
   SQL = SQL & "PO_ID                    ID_TYPE , "
   SQL = SQL & "PO_NO                    CODE_TYPE , "
   SQL = SQL & "FROM_PERIOD                    DATE_TYPE , "
   SQL = SQL & "TO_PERIOD                    DATE_TYPE , "
   SQL = SQL & "DOLLAR                    MONEY_TYPE , "
    SQL = SQL & "COUNTRY_CURRENCY2                    ID_TYPE , "
   SQL = SQL & "COUNTRY_CURRENCY1                    ID_TYPE , "
   SQL = SQL & "QTYP                    MONEY_TYPE,"
    SQL = SQL & "PACK                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_PERCENT                    MONEY_TYPE , "
   SQL = SQL & "WEIGHT_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "PACK_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "PRICE_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "DISCOUNT_PER_PACK                    MONEY_TYPE , "
   SQL = SQL & "MANUAL_FLAG                    FLAG_TYPE , "
   SQL = SQL & "MANUAL_CODE                    CODE_TYPE , "
   SQL = SQL & "MANUAL_NAME                    CODE_TYPE , "
   SQL = SQL & "RATE_TYPE                    ID_TYPE , "
   SQL = SQL & "EXTRA_DISCOUNT                    MONEY_TYPE , "
   SQL = SQL & "TRANSFER_WAGE                    MONEY_TYPE , "
   SQL = SQL & "STD_TRANSFER_CHARGE                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_ID_PK PRIMARY KEY (SUP_ITEM_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_DO_ITEM_FK FOREIGN KEY (DO_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR SUP_ITEM_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_13_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_13_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_03_13_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE BILLING_DOC ADD DO_NO CODE_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD TRUCK_NO CODE_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD DELIVERY_FEE MONEY_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD SENDER_NAME NAME_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD RECEIVE_NAME NAME_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD DEPARTMENT_ID ID_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD QUE_NO CODE_TYPE "   '
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD PR_NO CODE_TYPE "   '
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_13_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_13_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_03_13_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE CHEQUE ADD SUPPLIER_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE CHEQUE ADD CONSTRAINT CHEQUE_SUP_ID_FK FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_13_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1 " & Err.DESCRIPTION
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_14_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2007_03_14_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
  SQL = "ALTER TABLE CHEQUE ADD TRANSFER_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
      
  SQL = "UPDATE CHEQUE SET TRANSFER_FLAG = 'Y' "
   m_Conn.Execute (SQL)
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_14_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1 " & Err.DESCRIPTION
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_15_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_15_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE CASH_DOC ADD SUPPLIER_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE CASH_DOC ADD CONSTRAINT CASH_DOC_SUP_ID_FK FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE CASH_TRAN ADD SUPPLIER_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
  SQL = "ALTER TABLE CASH_TRAN ADD CONSTRAINT CASH_TRAN_SUP_ID_FK FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER "
   m_Conn.Execute (SQL)
      
      
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_15_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_15_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_15_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "UPDATE CHEQUE SET TRANSFER_FLAG = 'N' "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_15_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_15_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_15_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD POST_TYPE ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE CASH_DOC_POST SET POST_TYPE =  " & POST_CLEAR
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_15_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_20_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_20_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   Dim m_Sp As CSystemParam
   Set m_Sp = New CSystemParam
   m_Sp.AddEditMode = SHOW_ADD
   m_Sp.PARAM_NAME = "SHOW_IMPORT_INVENTORY"
   m_Sp.PARAM_VALUE = "N"
   m_Sp.PARAM_TYPE = "I"
   m_Sp.PARAM_DESC = ""
   Call m_Sp.AddEditData
      
   Set m_Sp = Nothing
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_20_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_20_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_20_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE CHEQUE ADD CHEQUE_RCP_DATE DATE_TYPE "
   m_Conn.Execute (SQL)
       
   SQL = "ALTER TABLE CHEQUE ADD CHEQUE_UMN_DATE DATE_TYPE "              'UP MONEY DATE 
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_20_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_20_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_20_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "UPDATE JOB_INOUT SET PARAM_ID = NULL WHERE PARAM_ID NOT IN ( SELECT PARAMETER_PROCESS_ID FROM PARAMETER_PROCESS) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_20_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_20_2_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_20_2_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                
   m_Conn.BeginTrans
   HasBegin = True
   
   Call glbDaily.PatchDocumentPriority2
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_20_2_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_21_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_21_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                
   m_Conn.BeginTrans
   HasBegin = True
   
   Call glbDaily.PatchDocumentPriority3
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_21_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_22_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_22_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
                
   m_Conn.BeginTrans
   HasBegin = True
   
   Call glbDaily.PatchDocumentPriority4
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_22_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_26_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_26_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM ADD PO_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD PO_NO CODE_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_26_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_26_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_26_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "UPDATE SUP_ITEM SET PO_ID =  NULL "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_PO_ID_FK FOREIGN KEY (PO_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_26_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_28_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  GL_DETAIL "
   SQL = SQL & "( "
   SQL = SQL & "GL_DETAIL_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "BILLING_DOC_ID                    ID_TYPE , "
   SQL = SQL & "GL_DESC                    ID_TYPE , "
   SQL = SQL & "GL_TYPE                    ID_TYPE , "
   SQL = SQL & "GL_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR GL_DETAIL_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_28_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE GL_DETAIL ADD CONSTRAINT GL_DETAIL_ID_PK PRIMARY KEY (GL_DETAIL_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_28_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE GL_DETAIL ADD CONSTRAINT GL_DETAIL_BILLING_DOC_ID_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_03_28_4_jill() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_4_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE GL_DETAIL ADD GL_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE GL_DETAIL ADD CONSTRAINT GL_DETAIL_GL_ID_FK FOREIGN KEY (GL_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_4_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_28_5_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_5_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE GL_DETAIL DROP GL_DESC  "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE GL_DETAIL ADD GL_DESC DESC_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_5_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_03_28_6_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_03_28_6_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE BILLING_DOC ADD PV_NO CODE_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_28_6_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_02_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_02_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  EVALUATE_PAY "
   SQL = SQL & "( "
   SQL = SQL & "EVALUATE_PAY_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "SUPPLIER_ID                    ID_TYPE , "
   SQL = SQL & "EVALUATE_DATE                    DATE_TYPE , "
   SQL = SQL & "EVALUATE_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR EVALUATE_PAY_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_02_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_02_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_02_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE EVALUATE_PAY ADD CONSTRAINT EVALUATE_PAY_ID_PK PRIMARY KEY (EVALUATE_PAY_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_02_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_02_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_02_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE EVALUATE_PAY ADD CONSTRAINT EVALUATE_PAY_SUPPLIER_ID_FK FOREIGN KEY (SUPPLIER_ID) REFERENCES SUPPLIER "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_02_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_02_4_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_02_4_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE EVALUATE_PAY ADD EVALUATE_PAY_DESC DESC_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_02_4_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM ADD TEMP_LOCATION_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE SUP_ITEM SET TEMP_LOCATION_ID = LOCATION_ID "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM DROP  LOCATION_ID "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD  LOCATION_ID ID_TYPE "
   m_Conn.Execute (SQL)
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_LOCATION_ID_FK FOREIGN KEY (LOCATION_ID) REFERENCES LOCATION "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE SUP_ITEM SET LOCATION_ID = TEMP_LOCATION_ID "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_4_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_4_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM ADD TEMP_PART_ITEM_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE SUP_ITEM SET TEMP_PART_ITEM_ID = PART_ITEM_ID "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_4_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_5_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_5_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM DROP  PART_ITEM_ID "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE SUP_ITEM ADD  PART_ITEM_ID ID_TYPE "
   m_Conn.Execute (SQL)
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_5_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_09_6_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_09_6_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_PART_ITEM_ID_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE SUP_ITEM SET PART_ITEM_ID = TEMP_PART_ITEM_ID "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_09_6_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_04_27_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_27_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   SQL = "ALTER TABLE MASTER_REF ADD SUM_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE  MASTER_REF SET  SUM_FLAG  = 'N' "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_27_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_04_27_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_27_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE BILLING_DOC ADD EFFECTIVE_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "UPDATE BILLING_DOC SET EFFECTIVE_FLAG = 'N' WHERE BILLING_DOC_ID NOT IN (SELECT BILLING_DOC_ID FROM CASH_TRAN) "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE BILLING_DOC SET EFFECTIVE_FLAG = 'Y' WHERE BILLING_DOC_ID IN (SELECT BILLING_DOC_ID FROM CASH_TRAN) "
   m_Conn.Execute (SQL)
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_27_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_04_27_2_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_04_27_2_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE REPORT_CONFIG ADD COMPUTER_NAME NAME_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_04_27_2_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_05_22_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_05_22_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   '--------------------------------------1
   
   SQL = "UPDATE  MASTER_REF SET  MASTER_FLAG  =  'Y' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1100'    "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - ' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1100'    "
   m_Conn.Execute (SQL)
   
   '--------------------------------------2
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . MP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1203'    "
   m_Conn.Execute (SQL)
   '--------------------------------------3
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . MA1' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1204'    "
   m_Conn.Execute (SQL)
   '--------------------------------------4
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . MA2' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1205'    "
   m_Conn.Execute (SQL)
   '--------------------------------------5
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . MH' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1206'    "
   m_Conn.Execute (SQL)
   
   '--------------------------------------6
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . DTS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1207'    "
   m_Conn.Execute (SQL)
   '--------------------------------------7
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . MGP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1212'    "
   m_Conn.Execute (SQL)
   '--------------------------------------8
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . HQS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1221'    "
   m_Conn.Execute (SQL)
   '--------------------------------------9
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . QMC' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1222'    "
   m_Conn.Execute (SQL)
      '--------------------------------------10
   SQL = "UPDATE MASTER_REF SET KEY_NAME = ' - . KTV' WHERE MASTER_AREA =  9 AND KEY_CODE =  '113-1226'    "
   m_Conn.Execute (SQL)
   
      '--------------------------------------11
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1002'    "
   m_Conn.Execute (SQL)
      '--------------------------------------12
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA1' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1003'    "
   m_Conn.Execute (SQL)
      '--------------------------------------13
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA2' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1004'    "
   m_Conn.Execute (SQL)
      '--------------------------------------14
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MH' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1201'    "
   m_Conn.Execute (SQL)
      '--------------------------------------15
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-DTS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1202'    "
   m_Conn.Execute (SQL)
   
      '--------------------------------------16
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-HQS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-1203'    "
   m_Conn.Execute (SQL)
      '--------------------------------------17
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-QMC' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-2001'    "
   m_Conn.Execute (SQL)
      '--------------------------------------18
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-' WHERE MASTER_AREA =  9 AND KEY_CODE =  '411-2006'    "
   m_Conn.Execute (SQL)
      '--------------------------------------19
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1002'    "
   m_Conn.Execute (SQL)
      '--------------------------------------20
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA1' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1003'    "
   m_Conn.Execute (SQL)
   
      '--------------------------------------21
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA2' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1004'    "
   m_Conn.Execute (SQL)
      '--------------------------------------22
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-DTS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1005'    "
   m_Conn.Execute (SQL)
      '--------------------------------------23
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MH' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1201'    "
   m_Conn.Execute (SQL)
      '--------------------------------------24
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-HQS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-1203'    "
   m_Conn.Execute (SQL)
      '--------------------------------------25
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-QMC' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-2001'    "
   m_Conn.Execute (SQL)
   
      '--------------------------------------26
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-' WHERE MASTER_AREA =  9 AND KEY_CODE =  '412-2006'    "
   m_Conn.Execute (SQL)
      '--------------------------------------27
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1002'    "
   m_Conn.Execute (SQL)
      '--------------------------------------28
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA1' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1003'    "
   m_Conn.Execute (SQL)
      '--------------------------------------29
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA2' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1004'    "
   m_Conn.Execute (SQL)
      '--------------------------------------30
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MH' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1201'    "
   m_Conn.Execute (SQL)

      '--------------------------------------31
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-DTS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1202'    "
   m_Conn.Execute (SQL)
      '--------------------------------------32
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-HQS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-1203'    "
   m_Conn.Execute (SQL)
      '--------------------------------------33
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-QMC' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-2001'    "
   m_Conn.Execute (SQL)
      '--------------------------------------34
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-' WHERE MASTER_AREA =  9 AND KEY_CODE =  '413-2006'    "
   m_Conn.Execute (SQL)
      '--------------------------------------35
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MP' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9004'    "
   m_Conn.Execute (SQL)
         
         '--------------------------------------36
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA1' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9005'    "
   m_Conn.Execute (SQL)
      '--------------------------------------37
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MA2' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9006'    "
   m_Conn.Execute (SQL)
      '--------------------------------------38
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-MH' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9007'    "
   m_Conn.Execute (SQL)
      '--------------------------------------39
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-DTS' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9009'    "
   m_Conn.Execute (SQL)
      '--------------------------------------40
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-QMC' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9101'    "
   m_Conn.Execute (SQL)
   
         '--------------------------------------41
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-KTV' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9104'    "
   m_Conn.Execute (SQL)
      '--------------------------------------42
   SQL = "UPDATE MASTER_REF SET KEY_NAME = '-' WHERE MASTER_AREA =  9 AND KEY_CODE =  '420-9999'    "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_05_22_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_05_22_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_05_22_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "UPDATE DOCUMENT_PRIORITY SET PRIORITY1 = 1, PRIORITY2 = 1 WHERE DOCUMENT_TYPE = 23 "
   m_Conn.Execute (SQL)
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_05_22_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_05_28_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_05_28_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE BILLING_DOC ADD PAY_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
            
   SQL = "UPDATE BILLING_DOC SET PAY_FLAG = 'N' "
   m_Conn.Execute (SQL)

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_05_28_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_05_29_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_05_29_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   Dim m_Sp As CMasterRef
   Set m_Sp = New CMasterRef
   m_Sp.AddEditMode = SHOW_ADD
   m_Sp.KEY_CODE = "412-2008"
   m_Sp.KEY_NAME = "-KTV"
   m_Sp.MASTER_AREA = ACCOUNT_LIST
   Call m_Sp.AddEditData
      
   Set m_Sp = New CMasterRef
   m_Sp.AddEditMode = SHOW_ADD
   m_Sp.KEY_CODE = "413-2008"
   m_Sp.KEY_NAME = "-KTV"
   m_Sp.MASTER_AREA = ACCOUNT_LIST
   Call m_Sp.AddEditData
   
   Set m_Sp = Nothing
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_29_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_05_29_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim ItemCount  As Long
   
   VersionStr = "2007_05_29_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
      
   Dim TempColl    As Collection
   Set TempColl = New Collection
   Call LoadMaster(Nothing, TempColl, ACCOUNT_LIST, , , 2)
   
   Dim m_Sp As CCustomerAccountList
   Dim m_Rs As ADODB.Recordset
   Dim Mr  As CMasterRef
   Set m_Sp = New CCustomerAccountList
   Set m_Rs = New ADODB.Recordset
   
   Call m_Sp.SetFieldValue("CUSTOMER_ACCOUNT_LIST_ID", -1)
   Call m_Sp.SetFieldValue("CUSTOMER_CODE", "M-5002")
   Call m_Sp.SetFieldValue("FEATURE_TYPE_NO", "06")
   Call m_Sp.QueryData(2, m_Rs, ItemCount)
      
   Call m_Sp.PopulateFromRS(2, m_Rs)
   
   Set Mr = GetObject("CMasterRef", TempColl, "413-2008")
   
   Call m_Sp.SetFieldValue("CREDIT_ID", Mr.KEY_ID)
   m_Sp.ShowMode = SHOW_EDIT
   Call m_Sp.AddEditData
   
   Set m_Rs = Nothing
   Set m_Sp = Nothing
   
   Set m_Sp = New CCustomerAccountList
   Set m_Rs = New ADODB.Recordset
   Call m_Sp.SetFieldValue("CUSTOMER_ACCOUNT_LIST_ID", -1)
   Call m_Sp.SetFieldValue("CUSTOMER_CODE", "M-5002")
   Call m_Sp.SetFieldValue("PART_GROUP_NO", "00")
   Call m_Sp.QueryData(2, m_Rs, ItemCount)
      
   Call m_Sp.PopulateFromRS(2, m_Rs)
   
   Set Mr = GetObject("CMasterRef", TempColl, "412-2008")
   
   Call m_Sp.SetFieldValue("CREDIT_ID", Mr.KEY_ID)
   m_Sp.ShowMode = SHOW_EDIT
   Call m_Sp.AddEditData
   
   
   Set m_Sp = Nothing
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_03_29_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_06_04_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_04_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE CASH_TRAN ADD UNDER_PAY MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CASH_TRAN ADD OVER_PAY MONEY_TYPE "
   m_Conn.Execute (SQL)

   SQL = "ALTER TABLE CASH_TRAN ADD ADVANCE_PAY MONEY_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
            
   SQL = "UPDATE BILLING_DOC SET PAY_FLAG = 'N' "
   m_Conn.Execute (SQL)

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_04_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_06_06_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_06_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE PART_ITEM ADD OLD_PART_ID ID_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
            
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_06_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_06_22_1_jill() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_22_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD BILLING_DOC_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_22_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_06_22_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_22_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD CONSTRAINT CASH_DOC_POST_BILL_ID_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_22_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_06_28_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_28_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "UPDATE BILLING_DOC BD SET BD.PAID_AMOUNT = (SELECT SUM(RI.PAID_AMOUNT) FROM RECEIPT_ITEM RI WHERE RI.DO_ID =  BD.BILLING_DOC_ID)  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_28_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2007_06_21_1_seub() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_21_1_seub"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE CASH_TRAN ADD WH_PAY MONEY_TYPE "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True
            
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_21_1_seub = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_06_29_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_29_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PART_GROUP ADD SET_PRODUCT_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_29_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_06_29_2_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_06_29_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE FEATURE_TYPE ADD FEATURE_GROUP_ID ID_TYPE  "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE FEATURE_TYPE ADD CONSTRAINT FEATURE_TYPE_GROUP_ID_FK FOREIGN KEY (FEATURE_GROUP_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PART_GROUP ADD CONSTRAINT PART_GROUP_SET_ID_FK FOREIGN KEY (SET_PRODUCT_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_06_29_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_11_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_11_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE SUPPLIER ADD SUPPLIER_CHEQUE_NAME NAME_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_11_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_18_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_18_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD WH_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_18_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_18_2_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_18_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_TRAN ADD INTERREST_PAY MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_18_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_18_3_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_18_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CASH_DOC_POST ADD INTERREST_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_18_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_25_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_25_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE BILLING_DOC ADD DUE_AMOUNT ID_TYPE "     '  duedate  15  due_amount  7   15-21/07/50
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_25_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_07_26_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_07_26_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   
   m_Conn.BeginTrans
   HasBegin = True
   
   Dim CP  As CCashDocPost
   Dim m_Rs  As ADODB.Recordset
   Dim ItemCount As Long
   Set CP = New CCashDocPost
   Set m_Rs = New ADODB.Recordset
   
   Call CP.QueryData(1, m_Rs, ItemCount)
   While Not m_Rs.EOF
      Call CP.PopulateFromRS(1, m_Rs)
      
      SQL = "UPDATE BILLING_DOC SET DOCUMENT_NO = '" & CP.GetFieldValue("BILLING_DOC_NO") & "' WHERE BILLING_DOC_ID = " & CP.GetFieldValue("BILLING_DOC_ID")
      m_Conn.Execute (SQL)
      
      m_Rs.MoveNext
   Wend
   
   Set m_Rs = Nothing
   Set CP = Nothing
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_07_26_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_08_14_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_08_14_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   
   m_Conn.BeginTrans
   HasBegin = True
   
   Dim CP  As CCashDocPost
   Dim m_Rs  As ADODB.Recordset
   Dim ItemCount As Long
   Set CP = New CCashDocPost
   Set m_Rs = New ADODB.Recordset
   
   Call CP.QueryData(1, m_Rs, ItemCount)
   While Not m_Rs.EOF
      Call CP.PopulateFromRS(1, m_Rs)
      
      SQL = "UPDATE BILLING_DOC SET DOCUMENT_NO = '" & CP.GetFieldValue("BILLING_DOC_NO") & "' WHERE BILLING_DOC_ID = " & CP.GetFieldValue("BILLING_DOC_ID")
      m_Conn.Execute (SQL)
      
      m_Rs.MoveNext
   Wend
   
   Set m_Rs = Nothing
   Set CP = Nothing
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_08_14_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2007_10_24_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2007_10_24_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE JOB ADD YYYYMM CODE_TYPE "     '
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE JOB SET YYYYMM = SUBSTR(JOB_DATE, 1, 7) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2007_10_24_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2008_02_13_1_jill() As Boolean
On Error GoTo ErrorHandler
'On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2008_02_13_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE INVENTORY_DOC ADD YYYYMM CODE_TYPE "     '
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE INVENTORY_DOC SET YYYYMM = SUBSTR(DOCUMENT_DATE, 1, 7) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2008_02_13_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2009_05_04_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2009_05_04_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  MONTHLY_ACCUM "
   SQL = SQL & "( "
   SQL = SQL & "MONTHLY_ACCUM_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "YYYYMM                    CODE_TYPE , "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "LOCATION_ID                    ID_TYPE , "
   SQL = SQL & "BALANCE_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "TOTAL_INCLUDE_PRICE                    MONEY_TYPE , "
   SQL = SQL & "AVG_PRICE                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR MONTHLY_ACCUM_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2009_05_04_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2009_05_04_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2009_05_04_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE MONTHLY_ACCUM ADD CONSTRAINT MONTHLY_ACCUM_ID_PK PRIMARY KEY (MONTHLY_ACCUM_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2009_05_04_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2009_05_04_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2009_05_04_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE MONTHLY_ACCUM ADD CONSTRAINT MONTHLY_ACCUM_PI_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE MONTHLY_ACCUM ADD CONSTRAINT MONTHLY_ACCUM_LI_FK FOREIGN KEY (LOCATION_ID) REFERENCES LOCATION "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2009_05_04_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2013_05_02_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2013_05_02_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  PLAN_PART "
   SQL = SQL & "( "
   SQL = SQL & "PLAN_PART_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "PLAN_AREA                   ID_TYPE , "
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "PLAN_DATE                    DATE_TYPE , "
   SQL = SQL & "PLAN_IN                    MONEY_TYPE , "
   SQL = SQL & "PLAN_OUT                    MONEY_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR PLAN_PART_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_05_02_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_05_02_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2013_05_02_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PLAN_PART ADD CONSTRAINT PLAN_PART_ID_PK PRIMARY KEY (PLAN_PART_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_05_02_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_05_02_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_05_02_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PLAN_PART ADD CONSTRAINT PLAN_PART_PI_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_05_02_3_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_05_02_4_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_05_02_4_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PLAN_PART ADD NOTE DESC_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_05_02_4_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_05_15_1_yong() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_05_15_1_yong"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PART_ITEM ADD CANCEL_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE PART_ITEM SET CANCEL_FLAG = 'N' "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_05_15_1_yong = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_06_03_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_06_03_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PLAN_PART ADD CANCEL_FLAG FLAG_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "UPDATE PLAN_PART SET CANCEL_FLAG = 'N' "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_06_03_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_06_17_1_yong() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_06_17_1_yong"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE PART_ITEM ADD NUMBER_PLC_ID CODE_TYPE UNIQUE"
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_06_17_1_yong = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_06_26_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_06_26_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PART_ITEM ADD DEFAULT_LOCATION ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_06_26_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2013_06_26_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2013_06_26_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE PART_ITEM ADD CONSTRAINT PART_ITEM_LOCATION_FK FOREIGN KEY (DEFAULT_LOCATION) REFERENCES LOCATION "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2013_06_26_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_01_13_1_pui() As Boolean
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "2015_01_13_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE BILLING_DOC ADD GENERATION  DESC_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD  REFERENCE DESC_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE BILLING_DOC ADD FARM_NAME DESC_TYPE "
   m_Conn.Execute (SQL)
                              
'   SQL = "ALTER TABLE BILLING_DOC ADD PAYMENT_TYPE ID_TYPE "
'   m_Conn.Execute (SQL)

   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_01_13_1_pui = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_2015_02_02_1_pui() As Boolean '
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
Dim IsOK As Boolean

   VersionStr = "2015_02_02_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE SUP_ITEM  ADD PROJECT_NAME_ID  ID_TYPE "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE LOT_ITEM ADD  PROJECT_NAME_ID  ID_TYPE "
   m_Conn.Execute (SQL)
   

   
   m_Conn.BeginTrans
   HasBegin = True
                              
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_02_02_1_pui = True
   Exit Function
   
ErrorHandler:
   Debug.Print Err.DESCRIPTION
   If HasBegin Then
      m_Conn.RollbackTrans
   End If
End Function

Public Function Patch_2015_02_02_2_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_02_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE SUP_ITEM ADD CONSTRAINT SUP_ITEM_PROJECT_NAME_ID_FK FOREIGN KEY (PROJECT_NAME_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)


   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_02_2_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_02_02_3_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_02_3_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)


    SQL = "ALTER TABLE LOT_ITEM ADD CONSTRAINT LOT_ITEM_PROJECT_NAME_ID_FK FOREIGN KEY (PROJECT_NAME_ID) REFERENCES MASTER_REF "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_02_3_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function





Public Function Patch_2015_02_20_1_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_02_20_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  ACC_FOL "
   SQL = SQL & "( "
   SQL = SQL & "ACC_FOL_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "CUSTOMER_ID                 ID_TYPE , "
   SQL = SQL & "FOL_NOTE                    DESC_TYPE , "
   SQL = SQL & "FOL_DATE                    DATE_TYPE , "
   SQL = SQL & "CANCEL_FLAG                   FLAG_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL , "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR ACC_FOL_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_02_20_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_02_20_2_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_20_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE ACC_FOL  ADD CONSTRAINT ACC_FOL_ID_PK PRIMARY KEY (ACC_FOL_ID) "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_20_2_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_02_20_3_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_20_3_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE ACC_FOL ADD CONSTRAINT ACC_FOL_CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER"
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_20_3_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_02_20_4_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_20_4_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "CREATE TABLE  MKT_FOL "
   SQL = SQL & "( "
   SQL = SQL & "MKT_FOL_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "CUSTOMER_ID                 ID_TYPE , "
   SQL = SQL & "FOL_NOTE                    DESC_TYPE , "
   SQL = SQL & "FOL_DATE                    DATE_TYPE , "
   SQL = SQL & "CANCEL_FLAG                   FLAG_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)

   SQL = "CREATE GENERATOR  MKT_FOL_SEQ  "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_20_4_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_02_20_5_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_20_5_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE  MKT_FOL  ADD CONSTRAINT MKT_FOL_ID_PK PRIMARY KEY (MKT_FOL_ID) "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_20_5_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
'Public Function Patch_2015_02_20_6_pui() As Boolean
'On Error GoTo ErrorHandler
'Dim SQL As String
'Dim ServerDateTime As String
'Dim HasBegin As Boolean
'Dim VersionStr As String
'
'   VersionStr = "2015_02_20_6_pui"
'   HasBegin = False
'   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
'
'   SQL = "ALTER TABLE MKT_FOL ADD CONSTRAINT CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER"
'
'   m_Conn.Execute (SQL)
'
'   m_Conn.BeginTrans
'   HasBegin = True
'
'   SQL = "INSERT INTO PATCH_DELIVERY "
'   SQL = SQL & "( "
'   SQL = SQL & "PATCH_DELIVERY_ID, "
'   SQL = SQL & "PATCH_VERSION, "
'   SQL = SQL & "PATCH_DATE, "
'   SQL = SQL & "PATCH_BY "
'   SQL = SQL & ") VALUES "
'   SQL = SQL & "( "
'   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
'   SQL = SQL & "'" & VersionStr & "', "
'   SQL = SQL & "'" & ServerDateTime & "', "
'   SQL = SQL & "" & glbUser.USER_ID & " "
'   SQL = SQL & ")"
'   m_Conn.Execute (SQL)
'
'   m_Conn.CommitTrans
'   HasBegin = False
'
'   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
'   glbErrorLog.ShowUserError
'
'   Patch_2015_02_20_6_pui = True
'   Exit Function
'
'ErrorHandler:
'      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
'      glbErrorLog.ShowUserError
'
'   If HasBegin Then
'      m_Conn.RollbackTrans
'      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
'      glbErrorLog.ShowUserError
'   End If
'End Function

Public Function Patch_2015_02_20_6_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_02_20_6_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE MKT_FOL ADD CONSTRAINT MKT_FOL_CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER"

   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_02_20_6_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function


Public Function Patch_2015_03_18_1_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_03_18_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
  
   SQL = " ALTER TABLE CUSTOMER ADD MAX_CREDIT LEN_TYPE  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
      
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_18_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1"
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_21_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_03_21_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CUSTOMER ADD SUSPEND_SALES FLAG_TYPE DEFAULT 'N'  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_21_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_21_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2015_03_21_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "UPDATE CUSTOMER SET SUSPEND_SALES = 'N' "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_21_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_03_27_1_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_03_27_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  CHEQUE_DOC"
   SQL = SQL & "( "
   SQL = SQL & "CHEQUE_DOC_ID                       ID_TYPE NOT NULL, "
  SQL = SQL & "CHEQUE_DOC_NO                      CODE_TYPE , "
  SQL = SQL & "CHEQUE_DOC_DATE                DATE_TYPE , "
   SQL = SQL & "BADCHEQUE_FLAG                FLAG_TYPE , "
   SQL = SQL & "PASSCHEQUE_FLAG              FLAG_TYPE , "
   SQL = SQL & "BADCHEQUE_DATE                DATE_TYPE , "
   SQL = SQL & "PASSCHEQUE_DATE               DATE_TYPE , "
   SQL = SQL & "CUSTOMER_ID                          ID_TYPE , "
   SQL = SQL & "CREATE_DATE                         DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY                              ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE                       DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY                              ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR CHEQUE_DOC_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_27_2_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_03_27_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CHEQUE_DOC ADD CONSTRAINT CHEQUE_DOC_ID_PK PRIMARY KEY (CHEQUE_DOC_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_2_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_27_3_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2015_03_27_3_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE CHEQUE_DOC ADD CONSTRAINT CUSTOMER_ID_FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER"
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_3_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_03_27_4_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_03_27_4_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  RECEIPT_CHEQUE_DOC"
   SQL = SQL & "( "
   SQL = SQL & "RECEIPT_CHEQUE_DOC_ID                       ID_TYPE NOT NULL, "
  SQL = SQL & "RECEIPT_CHEQUE_DOC_NO                      CODE_TYPE , "
  SQL = SQL & "RECEIPT_CHEQUE_DOC_DATE                DATE_TYPE , "
   SQL = SQL & "CHEQUE_DOC_ID                                            ID_TYPE , "
   SQL = SQL & "CREATE_DATE                         DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY                              ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE                       DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY                              ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR RECEIPT_CHEQUE_DOC_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_4_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_27_5_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_03_27_5_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD CONSTRAINT RECEIPT_CHEQUE_DOC_ID_PK PRIMARY KEY (RECEIPT_CHEQUE_DOC_ID) "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_5_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_03_27_6_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
      
   VersionStr = "2015_03_27_6_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD CONSTRAINT CHEQUE_DOC_ID_FK FOREIGN KEY (CHEQUE_DOC_ID) REFERENCES  CHEQUE_DOC"
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_03_27_6_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_05_21_1_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_05_21_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD BILLING_DOC_ID ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_05_21_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_05_21_2_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_05_21_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD CONSTRAINT  BILLING_DOC_ID_FK FOREIGN KEY (BILLING_DOC_ID) REFERENCES BILLING_DOC "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_05_21_2_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_05_26_1_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_05_26_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD RECEIPT_ITEM_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_05_26_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_05_26_2_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_05_26_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD CASH_DISCOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_05_26_2_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_05_26_3_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_05_26_3_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_CHEQUE_DOC ADD PAID_AMOUNT MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_05_26_3_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_06_10_1_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_06_10_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE  CHEQUE_DOC ADD AMOUNT_CHEQUE  MONEY_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_06_10_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_08_04_1_pui() As Boolean
'On Error GoTo ErrorHandler
On Error Resume Next
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_08_04_1_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "ALTER TABLE RECEIPT_ITEM ADD CHEQUE_DOC_ID  ID_TYPE "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_08_04_1_pui = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function

Public Function Patch_2015_08_04_2_pui() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_08_04_2_pui"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE RECEIPT_ITEM ADD CONSTRAINT  CHEQUE_DOC_FK FOREIGN KEY (CHEQUE_DOC_ID) REFERENCES CHEQUE_DOC "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_08_04_2_pui = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_10_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_09_10_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  PLANNING "
   SQL = SQL & "( "
   SQL = SQL & "PLANNING_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "PLANNING_AREA                   ID_TYPE , "
   SQL = SQL & "PLANNING_FROM                    DATE_TYPE , "
   SQL = SQL & "PLANNING_TO                    DATE_TYPE , "
   SQL = SQL & "PLANNING_DATE                    DATE_TYPE , "
   SQL = SQL & "PLANNING_DESC                    DESC_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PLANNING ADD CONSTRAINT PLANNING_ID_PK PRIMARY KEY (PLANNING_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR PLANNING_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_10_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_10_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_09_10_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "                 CREATE TRIGGER PLANNING_BA FOR PLANNING "
   SQL = SQL & "  ACTIVE BEFORE INSERT "
   SQL = SQL & "  POSITION 0 "
   SQL = SQL & "  AS "
   SQL = SQL & "  BEGIN "
   SQL = SQL & "        NEW.PLANNING_ID  = GEN_ID (PLANNING_SEQ, 1); "
   SQL = SQL & "  END; "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_10_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_11_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_09_11_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "CREATE TABLE  PLANNING_ITEM "
   SQL = SQL & "( "
   SQL = SQL & "PLANNING_ITEM_ID             ID_TYPE NOT NULL, "
   SQL = SQL & "PLANNING_ID                   ID_TYPE , "
   SQL = SQL & "PLANNING_SUB_TYPE                   ID_TYPE , "                  '1. 2. 3.
   SQL = SQL & "PART_ITEM_ID                    ID_TYPE , "
   SQL = SQL & "PLAN_AMOUNT                    MONEY_TYPE , "
   SQL = SQL & "NOTE                    DESC_TYPE , "
   SQL = SQL & "CREATE_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "CREATE_BY             ID_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_DATE           DATE_TYPE NOT NULL, "
   SQL = SQL & "MODIFY_BY ID_TYPE NOT NULL "
   SQL = SQL & ") "
   m_Conn.Execute (SQL)
   
   SQL = "ALTER TABLE PLANNING_ITEM ADD CONSTRAINT PLANNING_ITEM_ID_PK PRIMARY KEY (PLANNING_ITEM_ID) "
   m_Conn.Execute (SQL)
   
   SQL = "CREATE GENERATOR PLANNING_ITEM_SEQ  "
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_11_1_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_11_2_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String
   
   VersionStr = "2015_09_11_2_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   SQL = "                 CREATE TRIGGER PLANNING_ITEM_BA FOR PLANNING_ITEM "
   SQL = SQL & "  ACTIVE BEFORE INSERT "
   SQL = SQL & "  POSITION 0 "
   SQL = SQL & "  AS "
   SQL = SQL & "  BEGIN "
   SQL = SQL & "        NEW.PLANNING_ITEM_ID  = GEN_ID (PLANNING_ITEM_SEQ, 1); "
   SQL = SQL & "  END; "
   m_Conn.Execute (SQL)
      
   m_Conn.BeginTrans
   HasBegin = True
   
   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)
   
   m_Conn.CommitTrans
   HasBegin = False
   
   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_11_2_jill = True
   Exit Function
   
ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError
      
   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_11_3_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_09_11_3_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE PLANNING_ITEM ADD CONSTRAINT  PLANNING_ITEM_FK FOREIGN KEY (PLANNING_ID) REFERENCES PLANNING "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError

   Patch_2015_09_11_3_jill = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_11_4_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_09_11_4_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE PLANNING_ITEM ADD CONSTRAINT  PLANNING_ITEM_PART_FK FOREIGN KEY (PART_ITEM_ID) REFERENCES PART_ITEM "
   m_Conn.Execute (SQL)

   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_11_4_jill = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
Public Function Patch_2015_09_17_1_jill() As Boolean
On Error GoTo ErrorHandler
Dim SQL As String
Dim ServerDateTime As String
Dim HasBegin As Boolean
Dim VersionStr As String

   VersionStr = "2015_09_17_1_jill"
   HasBegin = False
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)

   SQL = "ALTER TABLE PART_ITEM ADD NUMBER_LAB_ID CODE_TYPE UNIQUE"
   m_Conn.Execute (SQL)
   
   m_Conn.BeginTrans
   HasBegin = True

   SQL = "INSERT INTO PATCH_DELIVERY "
   SQL = SQL & "( "
   SQL = SQL & "PATCH_DELIVERY_ID, "
   SQL = SQL & "PATCH_VERSION, "
   SQL = SQL & "PATCH_DATE, "
   SQL = SQL & "PATCH_BY "
   SQL = SQL & ") VALUES "
   SQL = SQL & "( "
   SQL = SQL & "GEN_ID(PATCH_DELIVERY_SEQ, 1), "
   SQL = SQL & "'" & VersionStr & "', "
   SQL = SQL & "'" & ServerDateTime & "', "
   SQL = SQL & "" & glbUser.USER_ID & " "
   SQL = SQL & ")"
   m_Conn.Execute (SQL)

   m_Conn.CommitTrans
   HasBegin = False

   glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " done."
   glbErrorLog.ShowUserError
   
   Patch_2015_09_17_1_jill = True
   Exit Function

ErrorHandler:
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.1" & m_Conn.Errors(0)
      glbErrorLog.ShowUserError

   If HasBegin Then
      m_Conn.RollbackTrans
      glbErrorLog.LocalErrorMsg = "Patch to version " & VersionStr & " Error.2"
      glbErrorLog.ShowUserError
   End If
End Function
