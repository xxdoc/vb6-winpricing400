VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "CDoItemDup"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

Private m_Conn As ADODB.Connection

Public AddEditMode As SHOW_MODE_TYPE
Public QueryFlag As Long
Public OrderBy As Long
Public OrderType As Long
Public Flag As String
' End of generic data member

Public DO_ITEM_ID As Long
Public DO_ID As Long
Public PART_ITEM_ID As Long
Public LOCATION_ID As Long
Public ITEM_AMOUNT As Double
Public TOTAL_WEIGHT As Double
Public AVG_WEIGHT As Double
Public TOTAL_PRICE As Double
Public AVG_PRICE As Double
Public GUI_ID As Long
Public LINK_ID As Long
Public PIG_STATUS As Long
Public FEATURE_ID As Long
Public SOC_ID As Long
Public DISCOUNT_AMOUNT As Double
Public DEPOSIT_AMOUNT As Double
Public CONFIG_CODE As String
Public ITEM_DESC As String
Public DISPLAY_ID As Long
Public FROM_PERIOD As Date
Public TO_PERIOD As Date
Public WEIGHT_PER_PACK As Double
Public PACK_AMOUNT As Double
Public PRICE_PER_PACK As Double
Public DISCOUNT_PER_PACK As Double
Public MANUAL_FLAG As String
Public MANUAL_CODE As String
Public MANUAL_NAME As String
Public EXTRA_DISCOUNT As Double
Public RATE_TYPE As Long
Public PARCEL_TYPE As Long
Public TRANSFER_WAGE As Double
 Public STD_TRANSFER_CHARGE As Double
 
Public EMP_CODE As String
Public FEATURE_CODE As String
Public FEATURE_DESC As String
Public SOC_CODE As String
Public FROM_DATE As Date
Public TO_DATE As Date
Public COMMIT_FLAG As String
Public PIG_TYPE As String
Public PART_NO As String
Public PART_DESC As String
Public PIG_STATUS_NAME As String
Public LOCATION_NAME As String
Public PART_TYPE_NAME As String
Public PART_TYPE As Long
Public LOT_MANUAL As String
Public LOT_ITEM_ID As Long
Public INVENTORY_DOC_ID As Long
Public CUSTOMER_CODE As String
Public CUSTOMER_NAME As String
Public CSTTYPE_NAME As String
Public CUSTOMER_ID As Long
Public SERVICE_FLAG As String

Public UC_AMOUNT As Double
Public AC_AMOUNT As Double
Public MINIMUM_FLAG As String
Public CALCULATED_AMOUNT As Double
Public SUBSCRIBER_ID As Long
Public ACCOUNT_ID As Long
Public USAGE_DATE As Date
Public PO_NO As String
Public PO_ID As Long
Public DOCUMENT_NO As String
Public DOLLAR As Double
Public COUNTRY_CURRENCY1 As Long
Public COUNTRY_CURRENCY2 As Long
Public SubLotItems As Collection
Public UNIT_NAME As String
Public QTYP As Double
Public PACK As Double
Public DISCOUNT_PERCENT As Double
Public CUSTOMER_TYPE As Long
Public BEFORE_DISCOUNT_PRICE As Double
Public CURRENT_POSITION As Long
Public ACCEPT_BY As Long
Public LOGISTIC_FLAG As String
Public DOCUMENT_DATE As Date
Public DUE_DATE As Date
Public Credit As Long
Public TRUCK_NO As String
Public SUPPLIER_ID As Long
Public PACKAGE_TYPE As PACKAGE_TYPE
Public DOCUMENT_TYPE As Long
Public DOCUMENT_SUBTYPE As Long
Public RECEIPT_TYPE As Long
Public LOGISTIC_PRICE As Double
Public SALE_NAME As String
Public SALE_LNAME As String

Public DocTypeSet As String

Public FROM_CUSTOMER_CODE As String
Public TO_CUSTOMER_CODE As String

Public TOTAL_INCLUDE_PRICE As Double ' ต้นทุนขาย
Public TX_AMOUNT As Double    'จำนวน ในคลัง
Public RAW_COST As Double 'ต้นทุนขายเฉพาะจากวัตถุดิบไม่ได้คิดรวม ต้น ทุนอื่นๆ

Public ACC_CODE As String  'CODE รหัสบัญชี
Public ACC_NAME As String  'ชื่อ รหัสบัญชี
Public ACC_FLAG As String  'MasterFlag

Public PART_GROUP_NAME As String
Public FEATURE_TYPE_NAME As String

Private Sub Class_Initialize()
   Set m_Conn = glbDatabaseMngr.DBConnection
   FROM_DATE = -1
   TO_DATE = -1
   Set SubLotItems = New Collection
End Sub

'In this class we will not handle any error or any transaction
Public Function QueryData(Ind As Long, Rs As ADODB.Recordset, itemcount As Long)
Dim SQL1 As String
Dim SQL2 As String
Dim SelectStr1 As String
Dim SelectStr2 As String
Dim FromStr As String
Dim WhereStr As String
Dim OrderByStr As String
Dim OrderTypeStr As String
Dim TempDate As String
Dim SubLen As Long
Dim NewStr As String
Dim GroupByStr As String

   If Ind = 1 Then
      SelectStr1 = "SELECT UG.*, PT.*, LC.*, PI.*, UN.*, PS.*, FT.*, IVD.DOCUMENT_DATE, IVD.DOCUMENT_NO, IVD.COMMIT_FLAG, IVD.DOCUMENT_TYPE, IVD.INVENTORY_DOC_ID,UN.UNIT_NAME, UG.WEIGHT_PER_PACK DO_WEIGHT_PER_PACK "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM_DUP UG "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PI.PART_TYPE = PT.PART_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOCATION LC ON (UG.LOCATION_ID = LC.LOCATION_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN UNIT UN ON (PI.UNIT_COUNT = UN.UNIT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PRODUCT_STATUS PS ON (UG.PIG_STATUS = PS.PRODUCT_STATUS_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      
      WhereStr = ""
   ElseIf Ind = 2 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, UG.ITEM_DESC, UG.FEATURE_ID, UG.PART_ITEM_ID, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT, SUM(UG.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND (DOCUMENT_TYPE IN (1, 2, 5)) "
   ElseIf Ind = 3 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT, SUM(UG.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.PACK_AMOUNT) PACK_AMOUNT, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 4 Then
      SelectStr1 = "SELECT IVD.ACCEPT_BY, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT, SUM(UG.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.PACK_AMOUNT) PACK_AMOUNT, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (IVD.ACCEPT_BY = EM.EMP_ID) "

      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 5 Then
      SelectStr1 = "SELECT IVD.*, UG.*, CM.CUSTOMER_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, FT.FEATURE_CODE, FT.FEATURE_DESC "
      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "

      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 6 Then
      SelectStr1 = "SELECT IVD.PACKAGE_TYPE, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT, SUM(UG.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr1 = SelectStr1 & ",UG.ITEM_DESC "
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.PACK_AMOUNT) PACK_AMOUNT, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "

      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "

     ' WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND (PART_ITEM_ID IS NOT NULL OR FEATURE_ID IS NOT NULL ) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 7 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, CM.CUSTOMER_CODE, NM.LONG_NAME CUSTOMER_NAME "
      SelectStr1 = SelectStr1 & ", IVD.*, UG.*, FT.FEATURE_CODE, FT.FEATURE_DESC, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 8 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(DI.EXTRA_DISCOUNT) EXTRA_DISCOUNT, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (BD.SUPPLIER_ID IS NULL) "
   ElseIf Ind = 9 Then
      SelectStr1 = "SELECT BD.ACCOUNT_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      
      WhereStr = ""
   ElseIf Ind = 10 Then
      SelectStr1 = "SELECT DI.DO_ID, SUM(DI.TOTAL_PRICE) TOTAL_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (BD.SUPPLIER_ID IS NULL) "
   ElseIf Ind = 11 Then
      SelectStr1 = "SELECT DISTINCT UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC "

      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "

      WhereStr = "WHERE (UG.PART_ITEM_ID > 0) "
   ElseIf Ind = 12 Then
      SelectStr1 = "SELECT IVD.ACCEPT_BY, PI.PART_ITEM_ID, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT, SUM(UG.TOTAL_PRICE) TOTAL_PRICE "

      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "

      WhereStr = ""
   ElseIf Ind = 13 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, PI.PART_ITEM_ID, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT, SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT "

      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "

      WhereStr = ""
   ElseIf Ind = 14 Then
      SelectStr1 = "SELECT BD.BILLING_DOC_ID, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, CM.CUSTOMER_CODE, NM.LONG_NAME CUSTOMER_NAME, "
      SelectStr1 = SelectStr1 & "SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, "
      SelectStr1 = SelectStr1 & "SUM(DI.PACK_AMOUNT) PACK_AMOUNT, SUM(DI.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = ""
   ElseIf Ind = 15 Then
      SelectStr1 = "SELECT BD.BILLING_DOC_ID, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, BD.DUE_DATE, BD.CREDIT, CM.CUSTOMER_CODE, NM.LONG_NAME CUSTOMER_NAME, "
      SelectStr1 = SelectStr1 & "SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, "
      SelectStr1 = SelectStr1 & "SUM(DI.PACK_AMOUNT) PACK_AMOUNT, SUM(DI.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = ""
    ElseIf Ind = 16 Then
      SelectStr1 = "SELECT CM.CUSTOMER_ID, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC, SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT, SUM(UG.TOTAL_WEIGHT) TOTAL_WEIGHT "
      SelectStr1 = SelectStr1 & ",IVD.ACCEPT_BY,EM.EMP_CODE "
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.PACK_AMOUNT) PACK_AMOUNT, SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (IVD.ACCEPT_BY = EM.EMP_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FTT.FEATURE_TYPE_ID = FT.FEATURE_TYPE) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 17 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_ID, PI.PART_NO, FT.FEATURE_CODE, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 18 Then 'เหมือนกันกับ 8
      SelectStr1 = "SELECT CM.CUSTOMER_ID, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (DI.FEATURE_ID IS NULL) " 'เอาแต่จำนวนสินค้าอย่างเดียว
   ElseIf Ind = 19 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_ID, PI.PART_NO,PI.PART_DESC, FT.FEATURE_CODE,FT.FEATURE_DESC, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
      
   ElseIf Ind = 20 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_TYPE, CT.CSTTYPE_NAME, PI.PART_NO,PI.PART_DESC, FT.FEATURE_CODE,FT.FEATURE_DESC, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 21 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",EM.EMP_ID, NM.LONG_NAME, NM.LAST_NAME, PI.PART_NO,PI.PART_DESC, FT.FEATURE_CODE,FT.FEATURE_DESC, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (EM.EMP_ID = IVD.ACCEPT_BY) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (NM.NAME_ID = EN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 22 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_TYPE, CT.CSTTYPE_NAME,IVD.DOCUMENT_DATE "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_TYPE CT ON (CM.CUSTOMER_TYPE = CT.CSTTYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 23 Then
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ",CM.CUSTOMER_ID, EM.EMP_ID, NM.LONG_NAME, NM.LAST_NAME, PI.PART_NO,PI.PART_DESC, FT.FEATURE_CODE,FT.FEATURE_DESC, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE EM ON (EM.EMP_ID = IVD.ACCEPT_BY) "
      FromStr = FromStr & "LEFT OUTER JOIN EMPLOYEE_NAME EN ON (EN.EMP_ID = EM.EMP_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (NM.NAME_ID = EN.NAME_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   ElseIf Ind = 24 Then 'CreportInventory028
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ", PI.PART_NO,UG.PART_ITEM_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr1 = SelectStr1 & ",SUM(LT.TX_AMOUNT)  TX_AMOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL AND PART_ITEM_ID IS NOT NULL) "
   ElseIf Ind = 25 Then 'CreportProfit007
      SelectStr1 = "SELECT SUM(UG.ITEM_AMOUNT) ITEM_AMOUNT,SUM(UG.TOTAL_PRICE) TOTAL_PRICE,SUM(UG.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT "
      SelectStr1 = SelectStr1 & ",SUM(UG.PACK_AMOUNT) PACK_AMOUNT,SUM(UG.PRICE_PER_PACK) PRICE_PER_PACK "
      SelectStr1 = SelectStr1 & ",SUM(UG.AVG_PRICE) AVG_PRICE,SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr1 = SelectStr1 & ", PI.PART_NO, FT.FEATURE_CODE, PI.PARCEL_TYPE,UG.PART_ITEM_ID,UG.FEATURE_ID "
      SelectStr1 = SelectStr1 & ",SUM(LT.TOTAL_INCLUDE_PRICE)  TOTAL_INCLUDE_PRICE "
      SelectStr2 = "SELECT COUNT(*)  "

      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN LOT_ITEM LT ON (LT.INVENTORY_DOC_ID = IVD.INVENTORY_DOC_ID) AND (LT.LINK_ID = UG.LINK_ID) "
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) "
   
   
   ElseIf Ind = 26 Then 'CreportJv001
      SelectStr1 = "SELECT NM.LONG_NAME CUSTOMER_NAME "
      SelectStr1 = SelectStr1 & ",MR1.KEY_CODE ACC_CODE,MR1.KEY_NAME ACC_NAME,MR1.MASTER_FLAG ACC_FLAG"
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_ACCOUNT_LIST CA ON (CA.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN MASTER_REF MR1 ON (CA.DEBIT_ID = MR1.KEY_ID) "
      
'      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      'FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PT.PART_TYPE_ID = PI.PART_TYPE) "
      
'      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND MR1.KEY_CODE IS NOT NULL AND CA.ACCOUNT_LIST_TYPE =  1 "
      'WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND (PT.PART_GROUP_ID = CA.PART_GROUP_ID)  "
   ElseIf Ind = 27 Then 'CreportJv001
      SelectStr1 = "SELECT PG.PART_GROUP_NAME "
      SelectStr1 = SelectStr1 & ",MR1.KEY_CODE ACC_CODE,MR1.KEY_NAME ACC_NAME,MR1.MASTER_FLAG ACC_FLAG"
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_ACCOUNT_LIST CA ON (CA.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN MASTER_REF MR1 ON (CA.CREDIT_ID = MR1.KEY_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_TYPE PT ON (PT.PART_TYPE_ID = PI.PART_TYPE) "
      FromStr = FromStr & "LEFT OUTER JOIN PART_GROUP PG ON (PG.PART_GROUP_ID = PT.PART_GROUP_ID) "
      
 '     FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND MR1.KEY_CODE IS NOT NULL AND CA.ACCOUNT_LIST_TYPE =  1 AND (PT.PART_GROUP_ID = CA.PART_GROUP_ID) "
      
   ElseIf Ind = 28 Then 'CreportJv001
      SelectStr1 = "SELECT FTT.FEATURE_TYPE_NAME "
      SelectStr1 = SelectStr1 & ",MR1.KEY_CODE ACC_CODE,MR1.KEY_NAME ACC_NAME,MR1.MASTER_FLAG ACC_FLAG"
      SelectStr1 = SelectStr1 & ", SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_ACCOUNT_LIST CA ON (CA.CUSTOMER_ID = CM.CUSTOMER_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN MASTER_REF MR1 ON (CA.CREDIT_ID = MR1.KEY_ID) "
      
  '    FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE FT ON (UG.FEATURE_ID = FT.FEATURE_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN FEATURE_TYPE FTT ON (FT.FEATURE_TYPE = FTT.FEATURE_TYPE_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND MR1.KEY_CODE IS NOT NULL AND CA.ACCOUNT_LIST_TYPE =  2 AND (FT.FEATURE_TYPE = CA.FEATURE_TYPE) "
      
   ElseIf Ind = 29 Then 'CreportJv001
      SelectStr1 = "SELECT SUM(UG.TOTAL_PRICE) TOTAL_PRICE, SUM(UG.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM UG "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC IVD ON (UG.DO_ID = IVD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (IVD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
            
      FromStr = FromStr & "LEFT OUTER JOIN PART_ITEM PI ON (UG.PART_ITEM_ID = PI.PART_ITEM_ID) "
      
      WhereStr = "WHERE (CUSTOMER_ID IS NOT NULL) AND PART_ITEM_ID IS NULL AND FEATURE_ID IS NULL  "
   ElseIf Ind = 30 Then 'Fix CReportSell006_3
      SelectStr1 = "SELECT BD.BILLING_DOC_ID, "
      SelectStr1 = SelectStr1 & "SUM(DI.TOTAL_PRICE) TOTAL_PRICE, SUM(DI.ITEM_AMOUNT) ITEM_AMOUNT, SUM(DI.DISCOUNT_AMOUNT) DISCOUNT_AMOUNT, "
      SelectStr1 = SelectStr1 & "SUM(DI.PACK_AMOUNT) PACK_AMOUNT, SUM(DI.EXTRA_DISCOUNT) EXTRA_DISCOUNT "
      SelectStr2 = "SELECT COUNT(*)  "
      
      FromStr = "FROM DO_ITEM DI "
      FromStr = FromStr & "LEFT OUTER JOIN BILLING_DOC BD ON (DI.DO_ID = BD.BILLING_DOC_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN ACCOUNT AC ON (BD.ACCOUNT_ID = AC.ACCOUNT_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER CM ON (AC.CUSTOMER_ID = CM.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN CUSTOMER_NAME CN ON (CM.CUSTOMER_ID = CN.CUSTOMER_ID) "
      FromStr = FromStr & "LEFT OUTER JOIN NAME NM ON (CN.NAME_ID = NM.NAME_ID) "
      
      WhereStr = "WHERE (DI.FEATURE_ID IS NOT NULL) "
   End If
   
   If DO_ITEM_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DO_ITEM_ID = " & DO_ITEM_ID & ") "
      Else
         WhereStr = WhereStr & "AND (DO_ITEM_ID = " & DO_ITEM_ID & ") "
      End If
   End If
   
   If CUSTOMER_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CUSTOMER_ID = " & CUSTOMER_ID & ") "
      Else
         WhereStr = WhereStr & "AND (CUSTOMER_ID = " & CUSTOMER_ID & ") "
      End If
   End If
   
   If DO_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DO_ID = " & DO_ID & ") "
      Else
         WhereStr = WhereStr & "AND (DO_ID = " & DO_ID & ") "
      End If
   End If
   
   If LOCATION_ID > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (LOCATION_ID = " & LOCATION_ID & ") "
      Else
         WhereStr = WhereStr & "AND (LOCATION_ID = " & LOCATION_ID & ") "
      End If
   End If
   
   If Len(COMMIT_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (COMMIT_FLAG = '" & COMMIT_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (COMMIT_FLAG = '" & COMMIT_FLAG & "') "
      End If
   End If
      
   If Trim(CUSTOMER_NAME) <> "" Then
      If WildCard(CUSTOMER_NAME, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(LONG_NAME,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(LONG_NAME,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (LONG_NAME = '" & ChangeQuote(Trim(CUSTOMER_NAME)) & "')"
         Else
            WhereStr = WhereStr & "AND (LONG_NAME = '" & ChangeQuote(Trim(CUSTOMER_NAME)) & "')"
         End If
      End If
   End If

   If Trim(CUSTOMER_CODE) <> "" Then
      If WildCard(CUSTOMER_CODE, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (CUSTOMER_CODE = '" & ChangeQuote(Trim(CUSTOMER_CODE)) & "')"
         Else
            WhereStr = WhereStr & "AND (CUSTOMER_CODE = '" & ChangeQuote(Trim(CUSTOMER_CODE)) & "')"
         End If
      End If
   End If
   
   If Len(Trim(TO_CUSTOMER_CODE)) > 0 Then
      If WildCard(TO_CUSTOMER_CODE, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") <= '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(CUSTOMER_CODE,1," & SubLen & ") <= '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (CUSTOMER_CODE <= '" & ChangeQuote(Trim(TO_CUSTOMER_CODE)) & "')"
         Else
            WhereStr = WhereStr & "AND (CUSTOMER_CODE <= '" & ChangeQuote(Trim(TO_CUSTOMER_CODE)) & "')"
         End If
      End If
   End If
   
   If Trim(EMP_CODE) <> "" Then
      If WildCard(EMP_CODE, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(EMP_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(EMP_CODE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (EMP_CODE = '" & ChangeQuote(Trim(EMP_CODE)) & "')"
         Else
            WhereStr = WhereStr & "AND (EMP_CODE = '" & ChangeQuote(Trim(EMP_CODE)) & "')"
         End If
      End If
   End If
         
   If Trim(TRUCK_NO) <> "" Then
      If WildCard(TRUCK_NO, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(IVD.NOTE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(IVD.NOTE,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (IVD.NOTE = '" & ChangeQuote(Trim(TRUCK_NO)) & "')"
         Else
            WhereStr = WhereStr & "AND (IVD.NOTE = '" & ChangeQuote(Trim(TRUCK_NO)) & "')"
         End If
      End If
   End If
         
   If Trim(PART_NO) <> "" Then
      If WildCard(PART_NO, SubLen, NewStr) Then
         If WhereStr = "" Then
            WhereStr = "WHERE (SUBSTR(PI.PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         Else
            WhereStr = WhereStr & "AND (SUBSTR(PI.PART_NO,1," & SubLen & ") = '" & ChangeQuote(Trim(NewStr)) & "')"
         End If
      Else
         If WhereStr = "" Then
            WhereStr = "WHERE (PI.PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         Else
            WhereStr = WhereStr & "AND (PI.PART_NO = '" & ChangeQuote(Trim(PART_NO)) & "')"
         End If
      End If
   End If
    If FROM_DATE > -1 Then
      TempDate = DateToStringIntLow(Trim(FROM_DATE))
      If WhereStr = "" Then
         WhereStr = "WHERE (DOCUMENT_DATE >= '" & ChangeQuote(TempDate) & "')"
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_DATE >= '" & ChangeQuote(TempDate) & "')"
      End If
   End If

   If TO_DATE > -1 Then
      TempDate = DateToStringIntHi(Trim(TO_DATE))
      If WhereStr = "" Then
         WhereStr = "WHERE (DOCUMENT_DATE <= '" & ChangeQuote(TempDate) & "')"
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_DATE <= '" & ChangeQuote(TempDate) & "')"
      End If
   End If
         
   If CUSTOMER_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CUSTOMER_TYPE = " & CUSTOMER_TYPE & ") "
      Else
         WhereStr = WhereStr & "AND (CUSTOMER_TYPE = " & CUSTOMER_TYPE & ") "
      End If
   End If
   
   If Len(DocTypeSet) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DOCUMENT_TYPE IN " & DocTypeSet & ") "
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_TYPE IN " & DocTypeSet & ") "
      End If
   End If
   
   If PART_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE ((PART_TYPE = " & PART_TYPE & ") ) "
      Else
         WhereStr = WhereStr & "AND ((PART_TYPE = " & PART_TYPE & ")) " 'OR (PART_TYPE IS NULL)
      End If
   End If
   
   If CURRENT_POSITION > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (CURRENT_POSITION = " & CURRENT_POSITION & ") "
      Else
         WhereStr = WhereStr & "AND (CURRENT_POSITION = " & CURRENT_POSITION & ") "
      End If
   End If
   
   If DOCUMENT_TYPE > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (DOCUMENT_TYPE = " & DOCUMENT_TYPE & ") "
      Else
         WhereStr = WhereStr & "AND (DOCUMENT_TYPE = " & DOCUMENT_TYPE & ") "
      End If
   End If
   
   If Len(LOGISTIC_FLAG) > 0 Then
      If Len(WhereStr) <= 0 Then
         WhereStr = "WHERE (LOGISTIC_FLAG = '" & LOGISTIC_FLAG & "') "
      Else
         WhereStr = WhereStr & "AND (LOGISTIC_FLAG = '" & LOGISTIC_FLAG & "') "
      End If
   End If
   
   GroupByStr = ""
   If Ind = 2 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, UG.ITEM_DESC, UG.FEATURE_ID, UG.PART_ITEM_ID "
   ElseIf Ind = 3 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC "
   ElseIf Ind = 4 Then
      GroupByStr = "GROUP BY IVD.ACCEPT_BY, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID "
   ElseIf Ind = 6 Then
      GroupByStr = "GROUP BY IVD.PACKAGE_TYPE, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC,UG.ITEM_DESC "
   ElseIf Ind = 8 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID "
   ElseIf Ind = 9 Then
      GroupByStr = "GROUP BY BD.ACCOUNT_ID, BD.DOCUMENT_TYPE, BD.DOCUMENT_SUBTYPE, BD.RECEIPT_TYPE "
   ElseIf Ind = 10 Then
      GroupByStr = "GROUP BY DI.DO_ID "
   ElseIf Ind = 12 Then
      GroupByStr = "GROUP BY IVD.ACCEPT_BY, PI.PART_ITEM_ID "
   ElseIf Ind = 13 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, PI.PART_ITEM_ID "
   ElseIf Ind = 14 Then
      GroupByStr = "GROUP BY BD.BILLING_DOC_ID, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, CM.CUSTOMER_CODE, NM.LONG_NAME "
   ElseIf Ind = 15 Then
      GroupByStr = "GROUP BY BD.BILLING_DOC_ID, BD.DOCUMENT_NO, BD.DOCUMENT_DATE, BD.DUE_DATE, BD.CREDIT, CM.CUSTOMER_CODE, NM.LONG_NAME "
    ElseIf Ind = 16 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, UG.PART_ITEM_ID, PI.PART_NO, PI.PART_DESC, PI.PARCEL_TYPE, UG.FEATURE_ID, FT.FEATURE_CODE, FT.FEATURE_DESC,IVD.ACCEPT_BY,EM.EMP_CODE "
   ElseIf Ind = 17 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID,PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID "
   ElseIf Ind = 18 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID "
   ElseIf Ind = 19 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID,PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID,PI.PART_DESC,FT.FEATURE_DESC "
   ElseIf Ind = 20 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_TYPE, CT.CSTTYPE_NAME, PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID,PI.PART_DESC,FT.FEATURE_DESC "
   ElseIf Ind = 21 Then
      GroupByStr = "GROUP BY EM.EMP_ID, NM.LONG_NAME, NM.LAST_NAME, PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID,PI.PART_DESC,FT.FEATURE_DESC "
   ElseIf Ind = 22 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_TYPE, CT.CSTTYPE_NAME, IVD.DOCUMENT_DATE "
   ElseIf Ind = 23 Then
      GroupByStr = "GROUP BY CM.CUSTOMER_ID, EM.EMP_ID, NM.LONG_NAME, NM.LAST_NAME, PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID,PI.PART_DESC,FT.FEATURE_DESC "
   ElseIf Ind = 24 Then
      GroupByStr = "GROUP BY PI.PART_NO,UG.PART_ITEM_ID "
   ElseIf Ind = 25 Then
      GroupByStr = "GROUP BY PI.PART_NO, PI.PARCEL_TYPE, FT.FEATURE_CODE,UG.PART_ITEM_ID,UG.FEATURE_ID "
   ElseIf Ind = 26 Then
      GroupByStr = "GROUP BY NM.LONG_NAME,MR1.KEY_CODE,MR1.KEY_NAME,MR1.MASTER_FLAG "
   ElseIf Ind = 27 Then
      GroupByStr = "GROUP BY PG.PART_GROUP_NAME,MR1.KEY_CODE,MR1.KEY_NAME,MR1.MASTER_FLAG "
   ElseIf Ind = 28 Then
      GroupByStr = "GROUP BY FTT.FEATURE_TYPE_NAME,MR1.KEY_CODE,MR1.KEY_NAME,MR1.MASTER_FLAG "
   ElseIf Ind = 30 Then
      GroupByStr = "GROUP BY BD.BILLING_DOC_ID "
   End If
   
   OrderByStr = ""
   OrderTypeStr = ""

   If Ind = 1 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY DO_ITEM_ID "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY DO_ITEM_ID "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY DOCUMENT_DATE DESC, TRANSACTION_SEQ "
      ElseIf OrderBy = 4 Then
         OrderByStr = "ORDER BY LOCATION_ID DESC, DOCUMENT_DATE DESC, TRANSACTION_SEQ "
      ElseIf OrderBy = 5 Then
         OrderByStr = "ORDER BY PT.PART_TYPE_NO "
      ElseIf OrderBy = 6 Then
         OrderByStr = "ORDER BY PI.PART_NO "
      ElseIf OrderBy = 7 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_DATE "
      ElseIf OrderBy = 8 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_NO "
      ElseIf OrderBy = 9 Then
         OrderByStr = "ORDER BY LC.LOCATION_NO "
      Else
         OrderByStr = "ORDER BY DO_ITEM_ID "
      End If
   ElseIf Ind = 2 Then
      If Ind = 1 Then
         OrderByStr = "ORDER BY CUSTOMER_CODE "
      ElseIf Ind = 2 Then
         OrderByStr = "ORDER BY LONG_NAME "
      Else
         OrderByStr = "ORDER BY CUSTOMER_CODE "
      End If
   ElseIf Ind = 3 Then
      If Ind = 1 Then
         OrderByStr = "ORDER BY CUSTOMER_CODE "
      ElseIf Ind = 2 Then
         OrderByStr = "ORDER BY PART_NO "
      Else
         OrderByStr = "ORDER BY CUSTOMER_CODE "
      End If
   ElseIf Ind = 4 Then
      If Ind = 1 Then
         OrderByStr = "ORDER BY EMP_CODE "
      ElseIf Ind = 2 Then
         OrderByStr = "ORDER BY PART_NO "
      Else
         OrderByStr = "ORDER BY EMP_CODE "
      End If
   ElseIf Ind = 5 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY IVD.NOTE ASC, IVD.DOCUMENT_DATE "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY IVD.DOCUMENT_NO ASC, PART_NO ASC, FEATURE_CODE "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY IVD.NOTE ASC, IVD.DOCUMENT_NO  "
      ElseIf OrderBy = 4 Then
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, IVD.DOCUMENT_NO "
      End If
   ElseIf Ind = 6 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY PART_NO ASC, FEATURE_CODE "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY PACKAGE_TYPE ASC, PART_NO ASC, FEATURE_CODE "
      End If
   ElseIf Ind = 7 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, PI.PART_NO ASC, FT.FEATURE_CODE "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY NM.LONG_NAME ASC, PI.PART_NO ASC, FT.FEATURE_CODE  "
      Else
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, IVD.DOCUMENT_DATE ASC, IVD.DOCUMENT_NO ASC, PI.PART_NO ASC, FT.FEATURE_CODE  "
      End If
   ElseIf Ind = 8 Then
      OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 9 Then
      OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 10 Then
      OrderByStr = "ORDER BY DI.DO_ID "
   ElseIf Ind = 11 Then
      OrderByStr = "ORDER BY PI.PART_NO "
   ElseIf Ind = 12 Then
      OrderByStr = "ORDER BY PI.PART_ITEM_ID "
   ElseIf Ind = 13 Then
      OrderByStr = "ORDER BY PI.PART_ITEM_ID "
   ElseIf Ind = 14 Then
      OrderByStr = "ORDER BY BD.DOCUMENT_DATE ASC, BD.DOCUMENT_NO "
   ElseIf Ind = 15 Then
      OrderByStr = "ORDER BY BD.CREDIT ASC, CM.CUSTOMER_CODE ASC, BD.DUE_DATE ASC, BD.DOCUMENT_NO "
    ElseIf Ind = 16 Then
      If Ind = 1 Then
         OrderByStr = "ORDER BY EM.EMP_CODE ASC,CUSTOMER_CODE "
      ElseIf Ind = 2 Then
         OrderByStr = "ORDER BY EM.EMP_CODE ASC,PART_NO "
      Else
         OrderByStr = "ORDER BY EM.EMP_CODE ASC,CUSTOMER_CODE "
      End If
   ElseIf Ind = 17 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC  "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY CM.CUSTOMER_CODE ASC, PART_NO ASC, FEATURE_CODE "
      End If
   ElseIf Ind = 18 Then
      OrderByStr = "ORDER BY DO_ITEM_ID "
   ElseIf Ind = 19 Then
      If OrderBy = 1 Then
         OrderByStr = "ORDER BY PART_NO ASC,FEATURE_CODE "
      ElseIf OrderBy = 2 Then
         OrderByStr = "ORDER BY PART_NO ASC,FEATURE_CODE "
      ElseIf OrderBy = 3 Then
         OrderByStr = "ORDER BY PART_NO ASC,FEATURE_CODE ASC,CM.CUSTOMER_CODE "
      End If
   ElseIf Ind = 20 Then
      OrderByStr = "ORDER BY CT.CSTTYPE_NAME ASC, PART_NO ASC, FEATURE_CODE "
   ElseIf Ind = 21 Then
      OrderByStr = "ORDER BY NM.LONG_NAME, NM.LAST_NAME ASC, PART_NO ASC, FEATURE_CODE "
   ElseIf Ind = 22 Then
      OrderByStr = "ORDER BY CT.CSTTYPE_NAME ASC, DOCUMENT_DATE "
   ElseIf Ind = 23 Then
      OrderByStr = "ORDER BY NM.LONG_NAME, NM.LAST_NAME ASC, CM.CUSTOMER_CODE ASC, PART_NO ASC, FEATURE_CODE "
   ElseIf Ind = 24 Then
      OrderByStr = "ORDER BY PART_NO "
   ElseIf Ind = 25 Then
         OrderByStr = "ORDER BY PART_NO ASC, FEATURE_CODE "
   ElseIf Ind = 26 Then
         OrderByStr = "ORDER BY MR1.KEY_CODE "
   ElseIf Ind = 27 Then
         OrderByStr = "ORDER BY MR1.KEY_CODE "
   ElseIf Ind = 28 Then
         OrderByStr = "ORDER BY MR1.KEY_CODE "
   ElseIf Ind = 30 Then
         OrderByStr = "ORDER BY BD.BILLING_DOC_ID "
   End If
   
   If OrderType = 1 Then
      OrderTypeStr = "ASC "
   ElseIf OrderType = 2 Then
      OrderTypeStr = "DESC "
   Else
      OrderTypeStr = "ASC "
   End If
   
   If Ind = 29 Then
      OrderByStr = ""
      OrderTypeStr = ""
   End If
   
   SQL1 = SelectStr1 & FromStr & WhereStr & GroupByStr & OrderByStr & OrderTypeStr
   SQL2 = SelectStr2 & FromStr & WhereStr
   
   Call glbDatabaseMngr.GetRs(SQL1, SQL2, True, itemcount, Rs, glbErrorLog)
End Function

Public Function CopyObject(Ind As Long, TempObj As CDoItem)
   DO_ITEM_ID = TempObj.DO_ITEM_ID                                  '1
   DO_ID = TempObj.DO_ID                                                             '2
   PART_ITEM_ID = TempObj.PART_ITEM_ID                          '3
   LOCATION_ID = TempObj.LOCATION_ID                          '4
   ITEM_AMOUNT = TempObj.ITEM_AMOUNT                          '5
   TOTAL_WEIGHT = TempObj.TOTAL_WEIGHT                          '6
   AVG_WEIGHT = TempObj.AVG_WEIGHT                          '7
   TOTAL_PRICE = TempObj.TOTAL_PRICE                          '8
   AVG_PRICE = TempObj.AVG_PRICE                          '9
   
   GUI_ID = TempObj.GUI_ID                          '10
   PIG_STATUS = TempObj.PIG_STATUS                          '11
   LINK_ID = TempObj.LINK_ID                          '12
   DEPOSIT_AMOUNT = TempObj.DEPOSIT_AMOUNT                          '13
   DISCOUNT_AMOUNT = TempObj.DISCOUNT_AMOUNT                          '14
   CONFIG_CODE = TempObj.CONFIG_CODE                          '15
   ITEM_DESC = TempObj.ITEM_DESC                          '16
   FEATURE_ID = TempObj.FEATURE_ID                          '17
   SOC_ID = TempObj.SOC_ID                          '18
   DISPLAY_ID = TempObj.DISPLAY_ID                          '19
   
   FEATURE_CODE = TempObj.FEATURE_CODE                          '20
   FEATURE_DESC = TempObj.FEATURE_DESC                          '21
   COMMIT_FLAG = TempObj.COMMIT_FLAG                          '22
   PART_TYPE = TempObj.PART_TYPE                          '23
   PART_NO = TempObj.PART_NO                          '24
   PART_DESC = TempObj.PART_DESC                          '25
   PART_TYPE_NAME = TempObj.PART_TYPE_NAME                          '26
   LOCATION_NAME = TempObj.LOCATION_NAME                          '27
   INVENTORY_DOC_ID = TempObj.INVENTORY_DOC_ID                          '28
   PO_NO = TempObj.PO_NO                          '29
   PO_ID = TempObj.PO_ID                          '30
   DOLLAR = TempObj.DOLLAR                  '31
      COUNTRY_CURRENCY1 = TempObj.COUNTRY_CURRENCY1                 '32
      COUNTRY_CURRENCY2 = TempObj.COUNTRY_CURRENCY2                 '33
     UNIT_NAME = TempObj.UNIT_NAME                                                                  '34
     QTYP = TempObj.QTYP                                                                                                '35
    PACK = TempObj.PACK                                                                                               '36
    MANUAL_FLAG = TempObj.MANUAL_FLAG                  '31
    RATE_TYPE = TempObj.RATE_TYPE                  '32
    MANUAL_NAME = TempObj.MANUAL_NAME                  '32
    MANUAL_CODE = TempObj.MANUAL_CODE                  '32
    WEIGHT_PER_PACK = TempObj.WEIGHT_PER_PACK                  '32
    PACK_AMOUNT = TempObj.PACK_AMOUNT                  '32
    PRICE_PER_PACK = TempObj.PRICE_PER_PACK                  '32
    DISCOUNT_PER_PACK = TempObj.DISCOUNT_PER_PACK                  '32
    TRANSFER_WAGE = TempObj.TRANSFER_WAGE                  '32
    STD_TRANSFER_CHARGE = TempObj.STD_TRANSFER_CHARGE                  '32
End Function
Public Function CopyObjectFromSo(Ind As Long, TempObj As CSaleOrder)
   DO_ID = TempObj.DO_ID                                                             '2
   PART_ITEM_ID = TempObj.PART_ITEM_ID                          '3
   LOCATION_ID = TempObj.LOCATION_ID                          '4
   ITEM_AMOUNT = TempObj.ITEM_AMOUNT                          '5
   TOTAL_WEIGHT = TempObj.TOTAL_WEIGHT                          '6
   AVG_WEIGHT = TempObj.AVG_WEIGHT                          '7
   TOTAL_PRICE = TempObj.TOTAL_PRICE                          '8
   AVG_PRICE = TempObj.AVG_PRICE                          '9
   
   GUI_ID = TempObj.GUI_ID                          '10
   PIG_STATUS = TempObj.PIG_STATUS                          '11
   LINK_ID = TempObj.LINK_ID                          '12
   DEPOSIT_AMOUNT = TempObj.DEPOSIT_AMOUNT                          '13
   DISCOUNT_AMOUNT = TempObj.DISCOUNT_AMOUNT                          '14
   CONFIG_CODE = TempObj.CONFIG_CODE                          '15
   ITEM_DESC = TempObj.ITEM_DESC                          '16
   FEATURE_ID = TempObj.FEATURE_ID                          '17
   SOC_ID = TempObj.SOC_ID                          '18
   DISPLAY_ID = TempObj.DISPLAY_ID                          '19
   
   FEATURE_CODE = TempObj.FEATURE_CODE                          '20
   FEATURE_DESC = TempObj.FEATURE_DESC                          '21
   COMMIT_FLAG = TempObj.COMMIT_FLAG                          '22
   PART_TYPE = TempObj.PART_TYPE                          '23
   PART_NO = TempObj.PART_NO                          '24
   PART_DESC = TempObj.PART_DESC                          '25
   PART_TYPE_NAME = TempObj.PART_TYPE_NAME                          '26
   LOCATION_NAME = TempObj.LOCATION_NAME                          '27
   INVENTORY_DOC_ID = TempObj.INVENTORY_DOC_ID                          '28
   PO_NO = TempObj.PO_NO                          '29
   PO_ID = TempObj.PO_ID                          '30
   
   DOLLAR = TempObj.DOLLAR                  '31
      COUNTRY_CURRENCY1 = TempObj.COUNTRY_CURRENCY1                 '32
      COUNTRY_CURRENCY2 = TempObj.COUNTRY_CURRENCY2                 '33
     UNIT_NAME = TempObj.UNIT_NAME                                                                  '34
     QTYP = TempObj.QTYP                                                                                                '35
    PACK = TempObj.PACK                                                                                               '36
    MANUAL_FLAG = TempObj.MANUAL_FLAG                  '31
    RATE_TYPE = TempObj.RATE_TYPE                  '32
    MANUAL_NAME = TempObj.MANUAL_NAME                  '32
    MANUAL_CODE = TempObj.MANUAL_CODE                  '32
    
    WEIGHT_PER_PACK = TempObj.WEIGHT_PER_PACK                  '32
    PACK_AMOUNT = TempObj.PACK_AMOUNT                  '32
    PRICE_PER_PACK = TempObj.PRICE_PER_PACK                  '32
    DISCOUNT_PER_PACK = TempObj.DISCOUNT_PER_PACK                  '32
    TRANSFER_WAGE = TempObj.TRANSFER_WAGE                  '32
    STD_TRANSFER_CHARGE = TempObj.STD_TRANSFER_CHARGE                  '32
End Function

Public Function PopulateFromRS(Ind As Long, Rs As ADODB.Recordset)
   If Ind = 1 Then
      DO_ITEM_ID = NVLI(Rs("DO_ITEM_ID"), -1)                          '1
      DO_ID = NVLI(Rs("DO_ID"), -1)                          '2
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)                          '3
      LOCATION_ID = NVLI(Rs("LOCATION_ID"), -1)                          '4
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)                          '5
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)                          '6
      AVG_WEIGHT = NVLD(Rs("AVG_WEIGHT"), 0)                          '7
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)                          '8
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)                          '9
      GUI_ID = NVLI(Rs("GUI_ID"), -1)                          '10
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)                          '11
      LINK_ID = NVLI(Rs("LINK_ID"), -1)                          '12
      DEPOSIT_AMOUNT = NVLD(Rs("DEPOSIT_AMOUNT"), 0)                          '13
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)                          '14
      CONFIG_CODE = NVLS(Rs("CONFIG_CODE"), "")                          '15
      ITEM_DESC = NVLS(Rs("ITEM_DESC"), "")                          '16
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)                          '17
      SOC_ID = NVLI(Rs("SOC_ID"), -1)                          '18
      DISPLAY_ID = NVLI(Rs("DISPLAY_ID"), -1)                          '19
      FROM_PERIOD = InternalDateToDate(NVLS(Rs("FROM_PERIOD"), ""))                          '20
      TO_PERIOD = InternalDateToDate(NVLS(Rs("TO_PERIOD"), ""))                          '21
      WEIGHT_PER_PACK = NVLD(Rs("DO_WEIGHT_PER_PACK"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      DISCOUNT_PER_PACK = NVLD(Rs("DISCOUNT_PER_PACK"), 0)
      MANUAL_FLAG = NVLS(Rs("MANUAL_FLAG"), "")
      MANUAL_CODE = NVLS(Rs("MANUAL_CODE"), "")
      MANUAL_NAME = NVLS(Rs("MANUAL_NAME"), "")
      RATE_TYPE = NVLI(Rs("RATE_TYPE"), -1)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      TRANSFER_WAGE = NVLD(Rs("TRANSFER_WAGE"), 0)
      STD_TRANSFER_CHARGE = NVLD(Rs("STD_TRANSFER_CHARGE"), 0)
      
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")                          '22
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")                          '23
      SERVICE_FLAG = NVLS(Rs("SERVICE_FLAG"), "")
      COMMIT_FLAG = NVLS(Rs("COMMIT_FLAG"), "")                          '24
      PART_TYPE = NVLI(Rs("PART_TYPE"), -1)                          '25
      PART_NO = NVLS(Rs("PART_NO"), "")                          '26
      PART_DESC = NVLS(Rs("PART_DESC"), "")                          '27
      PART_TYPE_NAME = NVLS(Rs("PART_TYPE_NAME"), "")                          '28
      LOCATION_NAME = NVLS(Rs("LOCATION_NAME"), "")                          '29
      INVENTORY_DOC_ID = NVLI(Rs("INVENTORY_DOC_ID"), -1)                          '30
      PO_NO = NVLS(Rs("PO_NO"), "")                          '31
      PO_ID = NVLI(Rs("PO_ID"), -1)                          '32
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")                          '33
      DOLLAR = NVLD(Rs("DOLLAR"), 0)                          '34
      COUNTRY_CURRENCY1 = NVLI(Rs("COUNTRY_CURRENCY1"), -1)                          '35
     COUNTRY_CURRENCY2 = NVLI(Rs("COUNTRY_CURRENCY2"), -1)                          '36
     UNIT_NAME = NVLS(Rs("UNIT_NAME"), "")                          '37
      QTYP = NVLD(Rs("QTYP"), 0)                          '38
      PACK = NVLD(Rs("PACK"), 0)                          '39
      DISCOUNT_PERCENT = NVLD(Rs("DISCOUNT_PERCENT"), 0)                          '40
   ElseIf Ind = 2 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      ITEM_DESC = NVLS(Rs("ITEM_DESC"), "")
      UNIT_NAME = NVLS(Rs("UNIT_NAME"), "")
   ElseIf Ind = 3 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      BEFORE_DISCOUNT_PRICE = TOTAL_PRICE + DISCOUNT_AMOUNT
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 1)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
'      MANUAL_CODE = NVLS(Rs("MANUAL_CODE"), "")
'      MANUAL_NAME = NVLS(Rs("MANUAL_NAME"), "")
   ElseIf Ind = 4 Then
      ACCEPT_BY = NVLI(Rs("ACCEPT_BY"), -1)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      BEFORE_DISCOUNT_PRICE = TOTAL_PRICE + DISCOUNT_AMOUNT
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 1)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
   ElseIf Ind = 5 Then
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      TRANSFER_WAGE = NVLD(Rs("TRANSFER_WAGE"), 0)
      STD_TRANSFER_CHARGE = NVLD(Rs("STD_TRANSFER_CHARGE"), 0)
      
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      TRUCK_NO = NVLS(Rs("NOTE"), "")
      MANUAL_CODE = NVLS(Rs("MANUAL_CODE"), "")
      MANUAL_NAME = NVLS(Rs("MANUAL_NAME"), "")
   ElseIf Ind = 6 Then
      PACKAGE_TYPE = NVLI(Rs("PACKAGE_TYPE"), -1)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      BEFORE_DISCOUNT_PRICE = TOTAL_PRICE + DISCOUNT_AMOUNT
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      ITEM_DESC = NVLS(Rs("ITEM_DESC"), "")
      
   ElseIf Ind = 7 Then
      DO_ITEM_ID = NVLI(Rs("DO_ITEM_ID"), -1)
      DO_ID = NVLI(Rs("DO_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      LOCATION_ID = NVLI(Rs("LOCATION_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      AVG_WEIGHT = NVLD(Rs("AVG_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      GUI_ID = NVLI(Rs("GUI_ID"), -1)
      PIG_STATUS = NVLI(Rs("PIG_STATUS"), -1)
      LINK_ID = NVLI(Rs("LINK_ID"), -1)
      DEPOSIT_AMOUNT = NVLD(Rs("DEPOSIT_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      CONFIG_CODE = NVLS(Rs("CONFIG_CODE"), "")
      ITEM_DESC = NVLS(Rs("ITEM_DESC"), "")
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      SOC_ID = NVLI(Rs("SOC_ID"), -1)
      DISPLAY_ID = NVLI(Rs("DISPLAY_ID"), -1)
      FROM_PERIOD = InternalDateToDate(NVLS(Rs("FROM_PERIOD"), ""))
      TO_PERIOD = InternalDateToDate(NVLS(Rs("TO_PERIOD"), ""))
      WEIGHT_PER_PACK = NVLD(Rs("WEIGHT_PER_PACK"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      DISCOUNT_PER_PACK = NVLD(Rs("DISCOUNT_PER_PACK"), 0)
      MANUAL_FLAG = NVLS(Rs("MANUAL_FLAG"), "")
      MANUAL_CODE = NVLS(Rs("MANUAL_CODE"), "")
      MANUAL_NAME = NVLS(Rs("MANUAL_NAME"), "")

      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      COMMIT_FLAG = NVLS(Rs("COMMIT_FLAG"), "")
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      INVENTORY_DOC_ID = NVLI(Rs("INVENTORY_DOC_ID"), -1)
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      DISCOUNT_PERCENT = NVLD(Rs("DISCOUNT_PERCENT"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 1)
      
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
   ElseIf Ind = 8 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 9 Then
      ACCOUNT_ID = NVLI(Rs("ACCOUNT_ID"), 0)
      DOCUMENT_TYPE = NVLI(Rs("DOCUMENT_TYPE"), 0)
      DOCUMENT_SUBTYPE = NVLI(Rs("DOCUMENT_SUBTYPE"), 0)
      RECEIPT_TYPE = NVLI(Rs("RECEIPT_TYPE"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 10 Then
      DO_ID = NVLI(Rs("DO_ID"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
   ElseIf Ind = 11 Then
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
   ElseIf Ind = 12 Then
      ACCEPT_BY = NVLI(Rs("ACCEPT_BY"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
   ElseIf Ind = 13 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 14 Then
      DO_ID = NVLI(Rs("BILLING_DOC_ID"), -1)
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
'      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
   ElseIf Ind = 15 Then
      DOCUMENT_NO = NVLS(Rs("DOCUMENT_NO"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
      DUE_DATE = InternalDateToDate(NVLS(Rs("DUE_DATE"), ""))
      CUSTOMER_CODE = NVLS(Rs("CUSTOMER_CODE"), "")
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      
      Credit = NVLI(Rs("CREDIT"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
'      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
    ElseIf Ind = 16 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      ACCEPT_BY = NVLI(Rs("ACCEPT_BY"), -1)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      BEFORE_DISCOUNT_PRICE = TOTAL_PRICE + DISCOUNT_AMOUNT
      PART_NO = NVLS(Rs("PART_NO"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 1)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      EMP_CODE = NVLS(Rs("EMP_CODE"), "")
   ElseIf Ind = 17 Then
'      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
'      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 18 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
   ElseIf Ind = 19 Then
'      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
'      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), 0)
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 20 Then
      CUSTOMER_TYPE = NVLI(Rs("CUSTOMER_TYPE"), 0)
      CSTTYPE_NAME = NVLS(Rs("CSTTYPE_NAME"), "")
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 21 Then
      ACCEPT_BY = NVLI(Rs("EMP_ID"), 0)
      SALE_NAME = NVLS(Rs("LONG_NAME"), "")
      SALE_LNAME = NVLS(Rs("LAST_NAME"), "")
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 22 Then
      CUSTOMER_TYPE = NVLI(Rs("CUSTOMER_TYPE"), 0)
      CSTTYPE_NAME = NVLS(Rs("CSTTYPE_NAME"), "")
      DOCUMENT_DATE = InternalDateToDate(NVLS(Rs("DOCUMENT_DATE"), ""))
            
            
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 23 Then
      CUSTOMER_ID = NVLI(Rs("CUSTOMER_ID"), -1)
      ACCEPT_BY = NVLI(Rs("EMP_ID"), 0)
      SALE_NAME = NVLS(Rs("LONG_NAME"), "")
      SALE_LNAME = NVLS(Rs("LAST_NAME"), "")
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PART_DESC = NVLS(Rs("PART_DESC"), "")
      FEATURE_DESC = NVLS(Rs("FEATURE_DESC"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
   ElseIf Ind = 24 Then
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
      TX_AMOUNT = NVLD(Rs("TX_AMOUNT"), 0)
   ElseIf Ind = 25 Then
'      FEATURE_ID = NVLI(Rs("FEATURE_ID"), -1)
'      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), -1)
      
      PART_ITEM_ID = NVLI(Rs("PART_ITEM_ID"), 0)
      FEATURE_ID = NVLI(Rs("FEATURE_ID"), 0)
      PART_NO = NVLS(Rs("PART_NO"), "")
      FEATURE_CODE = NVLS(Rs("FEATURE_CODE"), "")
      PARCEL_TYPE = NVLI(Rs("PARCEL_TYPE"), 0)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      PRICE_PER_PACK = NVLD(Rs("PRICE_PER_PACK"), 0)
      AVG_PRICE = NVLD(Rs("AVG_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      TOTAL_INCLUDE_PRICE = NVLD(Rs("TOTAL_INCLUDE_PRICE"), 0)
      
   ElseIf Ind = 26 Then
      CUSTOMER_NAME = NVLS(Rs("CUSTOMER_NAME"), "")
      ACC_CODE = NVLS(Rs("ACC_CODE"), "")
      ACC_NAME = NVLS(Rs("ACC_NAME"), "")
      ACC_FLAG = NVLS(Rs("ACC_FLAG"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
   ElseIf Ind = 27 Then
      ACC_CODE = NVLS(Rs("ACC_CODE"), "")
      ACC_NAME = NVLS(Rs("ACC_NAME"), "")
      ACC_FLAG = NVLS(Rs("ACC_FLAG"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      PART_GROUP_NAME = NVLS(Rs("PART_GROUP_NAME"), "")
   ElseIf Ind = 28 Then
      ACC_CODE = NVLS(Rs("ACC_CODE"), "")
      ACC_NAME = NVLS(Rs("ACC_NAME"), "")
      ACC_FLAG = NVLS(Rs("ACC_FLAG"), "")
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
      
      FEATURE_TYPE_NAME = NVLS(Rs("FEATURE_TYPE_NAME"), "")
   ElseIf Ind = 29 Then
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
   ElseIf Ind = 30 Then
      DO_ID = NVLI(Rs("BILLING_DOC_ID"), -1)
      
      ITEM_AMOUNT = NVLD(Rs("ITEM_AMOUNT"), 0)
'      TOTAL_WEIGHT = NVLD(Rs("TOTAL_WEIGHT"), 0)
      TOTAL_PRICE = NVLD(Rs("TOTAL_PRICE"), 0)
      PACK_AMOUNT = NVLD(Rs("PACK_AMOUNT"), 0)
      DISCOUNT_AMOUNT = NVLD(Rs("DISCOUNT_AMOUNT"), 0)
      EXTRA_DISCOUNT = NVLD(Rs("EXTRA_DISCOUNT"), 0)
   End If
End Function

Public Function AddEditData()
Dim ServerDateTime As String
Dim SQL1 As String
Dim ID As Long
Dim ID2 As Long
Dim TempID1 As String
Dim TempID2 As String
Dim TempID3 As String
Dim TempID4 As String

   TempID1 = PIG_STATUS
   If PIG_STATUS <= 0 Then
      TempID1 = "NULL"
   End If
   
   TempID2 = FEATURE_ID
   If FEATURE_ID <= 0 Then
      TempID2 = "NULL"
   End If
   
   TempID3 = SOC_ID
   If SOC_ID <= 0 Then
      TempID3 = "NULL"
   End If
   
   TempID4 = PO_ID
   If PO_ID <= 0 Then
      TempID4 = "NULL"
   End If
   
   Call glbDatabaseMngr.GetServerDateTime(ServerDateTime, glbErrorLog)
   
   If AddEditMode = SHOW_ADD Then
      Call glbDatabaseMngr.GetSeqID("DO_ITEM_SEQ", ID, glbErrorLog)
      
      SQL1 = "INSERT INTO DO_ITEM " & _
                     "( " & _
                     "   DO_ITEM_ID, " & _
                     "   DO_ID, " & _
                     "   PART_ITEM_ID, " & _
                     "   LOCATION_ID, " & _
                     "   ITEM_AMOUNT, " & _
                     "   TOTAL_WEIGHT, " & _
                     "   AVG_WEIGHT, " & _
                     "   TOTAL_PRICE, " & _
                     "   AVG_PRICE, "
            SQL1 = SQL1 & _
                     "   GUI_ID, " & _
                     "   LINK_ID, " & _
                     "   PIG_STATUS, " & _
                     "   DISCOUNT_AMOUNT, " & _
                     "   DEPOSIT_AMOUNT, " & _
                     "   CONFIG_CODE, " & _
                     "   ITEM_DESC, " & _
                     "   FEATURE_ID, " & _
                     "   SOC_ID, " & _
                     "   DISPLAY_ID, " & _
                     "   PO_NO, " & _
                     "   PO_ID, " & _
                     "   FROM_PERIOD, " & _
                     "   TO_PERIOD, " & _
                     "   DOLLAR, " & _
                     "   COUNTRY_CURRENCY1, " & _
                     "   COUNTRY_CURRENCY2, "
                    SQL1 = SQL1 & _
                     "   QTYP, " & _
                     "   PACK, " & _
                     "   DISCOUNT_PERCENT, " & _
                     "   WEIGHT_PER_PACK, " & _
                     "   PACK_AMOUNT, " & _
                     "   PRICE_PER_PACK, " & _
                     "   DISCOUNT_PER_PACK, " & _
                     "   MANUAL_FLAG, " & _
                     "   MANUAL_CODE, " & _
                     "   MANUAL_NAME, " & _
                     "   RATE_TYPE, " & _
                     "   EXTRA_DISCOUNT, " & _
                     "   TRANSFER_WAGE, " & _
                     "   STD_TRANSFER_CHARGE, " & _
                     "   CREATE_DATE, " & _
                    "    CREATE_BY, " & _
                    "    MODIFY_DATE, " & _
                    "    MODIFY_BY " & _
                     ") " & _
                     "VALUES "
            SQL1 = SQL1 & _
                     "( " & _
                         ID & "," & _
                         "" & DO_ID & "," & _
                         "" & PART_ITEM_ID & "," & _
                         "" & LOCATION_ID & "," & _
                         "" & ITEM_AMOUNT & "," & _
                         "" & TOTAL_WEIGHT & "," & _
                         "" & AVG_WEIGHT & "," & _
                         "" & TOTAL_PRICE & "," & _
                         "" & AVG_PRICE & "," & _
                         "" & GUI_ID & "," & _
                         "" & LINK_ID & "," & _
                         TempID1 & "," & _
                         "" & DISCOUNT_AMOUNT & "," & _
                         "" & DEPOSIT_AMOUNT & "," & _
                         "'" & CONFIG_CODE & "'," & _
                         "'" & ITEM_DESC & "',"
            SQL1 = SQL1 & _
                         TempID2 & "," & _
                         TempID3 & "," & _
                         DISPLAY_ID & "," & _
                         "'" & PO_NO & "'," & _
                         TempID4 & "," & _
                         "'" & ChangeQuote(Trim(DateToStringInt(FROM_PERIOD))) & "'," & _
                         "'" & ChangeQuote(Trim(DateToStringInt(TO_PERIOD))) & "'," & _
                         "'" & DOLLAR & "'," & _
                         "'" & COUNTRY_CURRENCY1 & "'," & _
                         "'" & COUNTRY_CURRENCY2 & "'," & _
                         "'" & QTYP & "'," & _
                         "'" & PACK & "'," & _
                         "'" & DISCOUNT_PERCENT & "',"
            SQL1 = SQL1 & _
                        WEIGHT_PER_PACK & "," & _
                        PACK_AMOUNT & "," & _
                        PRICE_PER_PACK & "," & _
                        DISCOUNT_PER_PACK & "," & _
                        "'" & ChangeQuote(Trim(MANUAL_FLAG)) & "'," & _
                        "'" & ChangeQuote(Trim(MANUAL_CODE)) & "'," & _
                        "'" & ChangeQuote(Trim(MANUAL_NAME)) & "'," & _
                        RATE_TYPE & "," & _
                        EXTRA_DISCOUNT & "," & _
                        TRANSFER_WAGE & "," & _
                        STD_TRANSFER_CHARGE & "," & _
                         "'" & ServerDateTime & "'," & _
                         glbUser.USER_ID & "," & _
                         "'" & ServerDateTime & "'," & _
                         glbUser.USER_ID & _
                     ") "
         DO_ITEM_ID = ID
   Else 'Show edit
'      Call glbDatabaseMngr.GetSeqID("TRANSACTION_SEQUENCE_SEQ", ID2, glbErrorLog)
      
      SQL1 = "UPDATE DO_ITEM SET " & _
                     "   DO_ID = " & DO_ID & ", " & _
                     "   PART_ITEM_ID = " & PART_ITEM_ID & ", " & _
                     "   LOCATION_ID = " & LOCATION_ID & ", " & _
                     "   ITEM_AMOUNT = " & ITEM_AMOUNT & ", " & _
                     "   TOTAL_WEIGHT = " & TOTAL_WEIGHT & ", " & _
                     "   AVG_WEIGHT = " & AVG_WEIGHT & ", " & _
                     "   TOTAL_PRICE = " & TOTAL_PRICE & ", " & _
                     "   AVG_PRICE = " & AVG_PRICE & ", " & _
                     "   GUI_ID = " & GUI_ID & ", " & _
                     "   LINK_ID = " & LINK_ID & ", " & _
                     "   PIG_STATUS = " & TempID1 & ", " & _
                     "   DISCOUNT_AMOUNT = " & DISCOUNT_AMOUNT & ", " & _
                     "   DEPOSIT_AMOUNT = " & DEPOSIT_AMOUNT & ", " & _
                     "   CONFIG_CODE = '" & CONFIG_CODE & "', " & _
                     "   ITEM_DESC = '" & ITEM_DESC & "', " & _
                     "   FEATURE_ID = " & TempID2 & ", " & _
                     "   SOC_ID = " & TempID3 & ", " & _
                     "   DISPLAY_ID = " & DISPLAY_ID & ", " & _
                     "   PO_NO = '" & PO_NO & "', " & _
                     "   PO_ID = " & TempID4 & ", "
               SQL1 = SQL1 & _
                     "   FROM_PERIOD = '" & ChangeQuote(Trim(DateToStringInt(FROM_PERIOD))) & "', " & _
                     "   TO_PERIOD = '" & ChangeQuote(Trim(DateToStringInt(TO_PERIOD))) & "', " & _
                    "   DOLLAR = '" & DOLLAR & "', " & _
                    "   COUNTRY_CURRENCY1 = '" & COUNTRY_CURRENCY1 & "', " & _
                    "   COUNTRY_CURRENCY2 = '" & COUNTRY_CURRENCY2 & "', " & _
                    "   QTYP = '" & QTYP & "', " & _
                    "   PACK = '" & PACK & "', " & _
                    "   DISCOUNT_PERCENT = '" & DISCOUNT_PERCENT & "', " & _
                     "   WEIGHT_PER_PACK = " & WEIGHT_PER_PACK & ", " & _
                     "   PACK_AMOUNT = " & PACK_AMOUNT & ", " & _
                     "   PRICE_PER_PACK = " & PRICE_PER_PACK & ", " & _
                     "   DISCOUNT_PER_PACK = " & DISCOUNT_PER_PACK & ", " & _
                     "   MANUAL_FLAG = '" & ChangeQuote(Trim(MANUAL_FLAG)) & "', " & _
                     "   MANUAL_CODE = '" & ChangeQuote(Trim(MANUAL_CODE)) & "', " & _
                     "   MANUAL_NAME = '" & ChangeQuote(Trim(MANUAL_NAME)) & "', " & _
                     "   RATE_TYPE = " & RATE_TYPE & ", " & _
                     "   EXTRA_DISCOUNT = " & EXTRA_DISCOUNT & ", " & _
                     "   TRANSFER_WAGE = " & TRANSFER_WAGE & ", " & _
                     "   STD_TRANSFER_CHARGE = " & STD_TRANSFER_CHARGE & ", " & _
                    "    MODIFY_DATE = '" & ServerDateTime & "', " & _
                    "    MODIFY_BY = " & glbUser.USER_ID & " " & _
                     "WHERE DO_ITEM_ID = " & DO_ITEM_ID
   End If
   
   If (AddEditMode = SHOW_ADD) Or (AddEditMode = SHOW_EDIT) Then
      m_Conn.Execute (SQL1)
   End If
End Function

Public Function DeleteData()
Dim SQL1 As String
      SQL1 = "DELETE FROM DO_ITEM WHERE DO_ITEM_ID = " & DO_ITEM_ID
      m_Conn.Execute (SQL1)
End Function

Private Sub Class_Terminate()
   Set SubLotItems = Nothing
End Sub
Public Function ShowDescText() As String
   If MANUAL_FLAG = "N" Then
      If DISPLAY_ID = 1 Then
         ShowDescText = ITEM_DESC
      ElseIf DISPLAY_ID = 2 Then
         ShowDescText = FEATURE_DESC
      ElseIf DISPLAY_ID = 3 Then
         ShowDescText = PART_DESC
      End If
   Else
      ShowDescText = MANUAL_NAME
   End If
End Function

Public Function ShowCodeText() As String
   If MANUAL_FLAG = "N" Then
      If DISPLAY_ID = 1 Then
         ShowCodeText = ""
      ElseIf DISPLAY_ID = 2 Then
         ShowCodeText = FEATURE_CODE
      ElseIf DISPLAY_ID = 3 Then
         ShowCodeText = PART_NO
      End If
   Else
      ShowCodeText = MANUAL_CODE
   End If
End Function
